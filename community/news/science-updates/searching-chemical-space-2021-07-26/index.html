<!DOCTYPE html>
<html lang="en-us">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.0/es5/tex-mml-chtml.min.js" integrity="sha512-ARgWTEVpGUlOMJL4bRTZtbFUs3LjpPC0YTRJc5FC1KVT18OTBb18Jowb6Is185zStFYyfUJhDgiHVzvt8w+8pg==" crossorigin="anonymous"></script>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="icon" type="image/png" href="https://openforcefield.org/favicon/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://openforcefield.org/favicon/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://openforcefield.org/favicon/favicon-32x32.png">
  <link rel="icon" type="image/ico" href="https://openforcefield.org/favicon/favicon.ico">
	<link rel="manifest" href="https://openforcefield.org/site.webmanifest">
	<title>Searching chemical space</title>
	
	
	
	<link rel="stylesheet" href="https://openforcefield.org/sass/index.min.d78ed623887aea8d388ea2b269ff6bd6f793863913d7532af625373655e478c5.css">
	
	
	<script type="text/javascript" src="https://openforcefield.org/js/jquery.min.js"></script>
	
	<script type="text/javascript" src="https://openforcefield.org/js/script.min.js"></script>
</head>
<body class="" data-color="default">
	



<div class="menu-button"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
  <path d="M1 3v2h18V3zm0 8h18V9H1zm0 6h18v-2H1z"/>
</svg>
</div>
<header>
	<a href="https://openforcefield.org/" class="logo"><img src="/img/icon.svg" /></a>
	
		<nav>
			<ul>
				<li>
					<a href="https://openforcefield.org/" class="menu-home">Home</a>
				</li>
				
					
					
					<li class=""><a data-menu="about" href="https://openforcefield.org/about/organization/">About</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu " data-submenu="about">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/about/organization/" class="">Organization</a></li>
										
											<li><a href="https://openforcefield.org/about/roadmap/" class="">Roadmap</a></li>
										
											<li><a href="https://openforcefield.org/about/team/" class="">Team</a></li>
										
											<li><a href="https://openforcefield.org/about/careers/openff/" class="">Careers</a></li>
										
											<li><a href="https://openforcefield.org/about/branding/" class="">Branding</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
					<li class=""><a data-menu="science" href="https://openforcefield.org/science/research">Science</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu " data-submenu="science">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/science/research/" class="">Research</a></li>
										
											<li><a href="https://openforcefield.org/science/publications/" class="">Publications</a></li>
										
											<li><a href="https://openforcefield.org/science/collaborative-projects/" class="">Collaborative projects</a></li>
										
											<li><a href="https://openforcefield.org/science/how-to-cite/" class="">How to cite</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
					<li class=""><a data-menu="software" href="https://openforcefield.org/software">Software</a></li>
					
				
					
					
					<li class=""><a data-menu="data" href="https://openforcefield.org/data">Data</a></li>
					
				
					
					
					<li class=""><a data-menu="force-fields" href="https://openforcefield.org/force-fields/force-fields/">Force Fields</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu " data-submenu="force-fields">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/force-fields/force-fields/" class="">Force Fields</a></li>
										
											<li><a href="https://openforcefield.org/force-fields/versioning/" class="">Versioning</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
						
					
					<li class="active"><a data-menu="community" href="https://openforcefield.org/community/news/general/">Community</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu active" data-submenu="community">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/community/news/general/" class="">News</a></li>
										
											<li><a href="https://openforcefield.org/community/events/webinars/" class="">Events</a></li>
										
											<li><a href="https://openforcefield.org/community/collaborate" class="">Collaborate</a></li>
										
											<li><a href="https://openforcefield.org/community/faq/" class="">FAQ</a></li>
										
											<li><a href="https://discourse.openforcefield.org/" class="">Forum</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
					<li class=""><a data-menu="how-to-join" href="https://openforcefield.org/how-to-join">How to join</a></li>
					
				
			</ul>
		</nav>
	
	<div class="search-button" style="display: none">
		<img src="/img/search.svg" />
	</div>
</header>
<div class="menu-back"></div>
<div class="submenus active">
	
		
			<div class="submenu " data-submenu="about">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/about/organization/" class="">Organization</a></li>
						
							<li><a href="https://openforcefield.org/about/roadmap/" class="">Roadmap</a></li>
						
							<li><a href="https://openforcefield.org/about/team/" class="">Team</a></li>
						
							<li><a href="https://openforcefield.org/about/careers/openff/" class="">Careers</a></li>
						
							<li><a href="https://openforcefield.org/about/branding/" class="">Branding</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
			<div class="submenu " data-submenu="science">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/science/research/" class="">Research</a></li>
						
							<li><a href="https://openforcefield.org/science/publications/" class="">Publications</a></li>
						
							<li><a href="https://openforcefield.org/science/collaborative-projects/" class="">Collaborative projects</a></li>
						
							<li><a href="https://openforcefield.org/science/how-to-cite/" class="">How to cite</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
	
		
	
		
			<div class="submenu " data-submenu="force-fields">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/force-fields/force-fields/" class="">Force Fields</a></li>
						
							<li><a href="https://openforcefield.org/force-fields/versioning/" class="">Versioning</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
			<div class="submenu active" data-submenu="community">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/community/news/general/" class="">News</a></li>
						
							<li><a href="https://openforcefield.org/community/events/webinars/" class="">Events</a></li>
						
							<li><a href="https://openforcefield.org/community/collaborate" class="">Collaborate</a></li>
						
							<li><a href="https://openforcefield.org/community/faq/" class="">FAQ</a></li>
						
							<li><a href="https://discourse.openforcefield.org/" class="">Forum</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
	
</div>

	<div class="subheader">
		<h1><b>open</b> force field</h1>
		<h3>An open and collaborative approach to better force fields</h3>
		
		

		
		
		
		
	</div>


	
		
	
	
		
		
				
	
	
		
		
				
	
	
		
		
			
				
					
				
			
				
					
				
			
			
				<div class="subheader-menu">
					<div>
						
							
								
							
							
								<div>
									<b><a href="https://openforcefield.org/community/news/general/" class="">News</a></b>
								</div>
							
						
							
								
							
							
								<div>
									<b><a href="https://openforcefield.org/community/news/science-updates/" class="">Science Updates</a></b>
								</div>
							
						
					</div>
				</div>
			
		
	

		
	

		
	

	<main class="single">
		<article>
			<h1>Searching chemical space</h1>
			
				<h6>
			
			
				Posted on 26 Jul 2021
			
			
				by Trevor Gokey
			
			
				</h6>
			
			<div>
				<p>The basis of SMIRNOFF is the use of SMIRKS (or SMARTS) patterns to define parameters. This has a lot of benefits and makes parameter design and force field fitting a unique experience. Because of this uniqueness I have found a need to use SMARTS in a way that just hasn&rsquo;t been needed until now. SMARTS are normally applied to a SMILES pattern which makes SMARTS a type of substructure query on a molecule. In order to create a new parameter we need a new SMARTS pattern. To find a new SMARTS pattern we need to compare the matching chemistries which are SMARTS patterns themselves to both each other and the force field parameter SMARTS pattern. Thus, we need to do things like perform a SMARTS search on a SMARTS pattern. An internet search on internet searches, if you will. I spent some time on this problem and this post is devoted to explaining some of the primary aspects of this work.</p>
<p>Let&rsquo;s make everything concrete with an example. Take an angle SMARTS <code>[*:1][#6:2][*:3]</code> and apply it to propane, C3H8. If we only consider angles where the SMARTS only use three atoms, we have a total of four SMARTS patterns: <code>[#6:1[#6:2]][#6:3]</code>, <code>[#6:1[#6:2]][#1:3]</code>, and <code>[#1:1[#6:2]][#1:3]</code> are <code>in</code> the force field SMARTS parameter <code>[*:1][#6:2][*:3]</code>. I will use the shorthand <code>CCC</code>, <code>CCH</code>, <code>HCH</code>, and <code>*C*</code> to refer to these patterns, respectively.</p>
<p>In order to work with these, we need a programmatic way to:</p>
<ol>
<li>Establish that the propane angle SMARTS patterns are, in fact, <code>in</code> the parameter SMARTS</li>
<li><em>Split</em> <code>*C*</code> in order to partition the propane angles into different parameters</li>
</ol>
<p>Splitting <code>*C*</code> is a lot harder than it looks. We know that we have three chemistries to handle meaning that there are four unique ways to partition this set. The underlying research question is which partitioning is optimal in the sense that we minimize the number of groups while maximizing performance. By group I mean a parameter in the SMIRNOFF force field, and by performance I mean the ability of the force field to accurately describe chemistry the parameter groups together. Should <code>CCC</code> and <code>HCH</code> have different force constants? Should <code>CCC</code> and <code>CCH</code> have the same equilibrium angle? Should they all use the same parameters?</p>
<p>Currently, we encounter &ldquo;chemical perception&rdquo; issues any time we are trying to either fit a custom set of parameters to a single molecule, or if we run into anomalies in the mainline force field where it appears to have bunched certain functional groups together with conflicting physics. The way it is currently solved in the first case is by randomly changing the SMARTS until the desired partition is achieved and by manual manipulation of the SMARTS in the latter case. Chemical space is large; good automation is hard. The partitioning issue highlights this perfectly. The number of ways we can group the three chemistries, <code>CCC</code>, <code>CCH</code>, and <code>HCH</code> is combinatorial problem, and isn&rsquo;t an issue here but it is for any useful case. Deciding which groups to actually select and use as parameters also requires SMARTS patterns that can encode the partitioning correctly. There are partitions that SMARTS simply cannot represent. This is essentially why, in our current approach of fitting parameters to single molecules, we require <em>a priori</em> the desired groups, and we use random jumps in the SMARTS patterns ad nauseam until the groups are distinct. This approach is generally intractable for the mainline force field, hence the use of manual intervention to split parameters.</p>
<p>Searching chemical space grabbed my attention because it seemed like such an underdeveloped area in Open Force Field, and there was a real need to automate parameter generation for the mainline force field. As someone with some background in computer science, the first time I learned about SMARTS, a knee-jerk thought to myself was &ldquo;how is equality defined between two SMARTS, and given a SMARTS, what SMARTS comes <em>next</em>?&rdquo; Equality and iteration are two important, and I believe necessary elements of most data structures. Defining equality is somewhat straightforward if we ignore symmetries (e.g. <code>[#6][#1]</code> versus <code>[#1][#6]</code>), but defining the next adjacent SMARTS is a little more esoteric. In the propane example, it makes sense that if I have an <code>HCH</code> angle, the <em>next</em> SMARTS would be <code>HCC</code>, and then <code>CCC</code>, or something along these lines. But how does one programmatically do this, and what was the underlying mental model I used to determine this? In any case, if we can determine the next SMARTS, we can iterate, and if we can iterate and establish equality, we can search, and searching is exactly what we need.</p>
<p>Long story short, we can search chemical space by treating a SMARTS pattern as a bunch of ordered switches. I call them bits, but switches give a nicer mental image. The <code>*C*</code> SMARTS has three atoms, and the <code>*</code> means all switches are <em>on</em>, and the center atom only has the carbon switch on. We can iterate through this SMARTS pattern by turning switches off, and a new SMARTS pattern is generated every time a switch is flipped. The effect of this is an enumeration of chemical space defined by the given SMARTS. Luckily, we don&rsquo;t need to consider the entire space of <code>*C*</code> as the wildcards allow <em>the entire periodic table</em>, but rather only the chemical space we have support for, e.g. the space defined by propane. As we include more molecules, the chemical space that the SMARTS covers will increase, meaning that more switches will turn on, e.g. <code>NCH</code>, <code>NC=C</code>, etc. With this method, we only have to consider this subset of the very large chemical space. In general, each parameter will carve out a chemical subspace, and turning off switches is a way to search inside the parameter.</p>
<p>I&rsquo;ve found general success in searching chemical space of a parameter by only searching the &ldquo;adjacent&rdquo; SMARTS patterns, meaning only a few switches at a time. More specifically, at most two switches for bonds and angles and three switches for torsions in effort to combat symmetries in the patterns. Not only does this avoid randomly jumping around it significantly reduces the candidates to consider. It also follows the idea of keeping the SMARTS patterns general: turning off one switch is equivalent to cutting the chemical space in half although it may not cut the dataset in half. Hand manipulation of SMARTS patterns usually goes against the grain on this principle. We tend to try to pull out very specific chemistries in a SMARTS, meaning that we in effect end up creating the least general parameter. Likely, there is a generalization that is equally effective and enjoys the benefit of capturing similar chemistry not yet observed or trained on. In other words, the generalized parameter is more <em>transferable</em> and less prone to overfitting. We strive for a mainline force field that &ldquo;always works&rdquo; or at least doesn&rsquo;t fail. We want coverage, accuracy, and simplicity. Hopefully it&rsquo;s not a &ldquo;here&rsquo;s three criteria, choose two&rdquo; type of deal.</p>
<h2 id="a-brief-code-example">A brief code example</h2>
<p>This section will show how chemical space can be searched. To keep things simple, we use propane and only distinguish SMARTS using elements. The following is some code that shows how this works, and will follow the above example: the <code>CCC</code>, <code>CCH</code>, and <code>HCH</code> angles of propane. These patterns will be applied to a <code>*C*</code> SMARTS parameter, and we will search and find splits using a single switch. Absent from this section is how to determine which split is &ldquo;better,&rdquo; since it would require some score or criteria for each angle. In my research, I use a variety of criteria, but all revolve around the quality of fit to some reference or calculated values.</p>
<p>First some plumbing to start things off. The <code>MoleculeGraph</code> will represent propane, and the <code>AngleEnvironment</code> will be used to describe the propane angles in addition to the force field parameter. <code>ATOM_UNIVERSE</code> is a utility to define what a wildcard atom is (<code>[*]</code>), and will help to give our SMARTS patterns a little more clarity.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> offsb.chem.graph <span style="color:#f92672">import</span> MoleculeGraph, AngleEnvironment
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> offsb.chem.types <span style="color:#f92672">import</span> ATOM_UNIVERSE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> reduce
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> operator <span style="color:#f92672">import</span> add
</span></span></code></pre></div><p>The SMILES and SMARTS languages contain many descriptors to encode a molecule. The typical fields for these descriptors are enabled by default, but to show the simple propane example we will turn off all defaults except the element field for atoms and bond order for bonds. We could have utilized the <code>H</code> field, which would be able to distinguish the methylene carbon without using graph operations. The methylene carbon is <code>[#6H2]</code> versus <code>[#6H3]</code> for the other two methyl carbons which are indistinguishable in propane.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">configure_fields</span>(obj):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    disable_atom_smarts_fields <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;H&#34;</span>, <span style="color:#e6db74">&#34;X&#34;</span>, <span style="color:#e6db74">&#34;x&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>, <span style="color:#e6db74">&#34;aA&#34;</span>, <span style="color:#e6db74">&#34;q&#34;</span>]
</span></span><span style="display:flex;"><span>    disable_bond_smarts_fields <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;aA&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> field <span style="color:#f92672">in</span> disable_atom_smarts_fields:
</span></span><span style="display:flex;"><span>        obj<span style="color:#f92672">.</span>atom_disable(field)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> field <span style="color:#f92672">in</span> disable_bond_smarts_fields:
</span></span><span style="display:flex;"><span>        obj<span style="color:#f92672">.</span>bond_disable(field)
</span></span></code></pre></div><h2 id="part-1-defining-and-chemically-perceiving-propane">Part 1: Defining and chemically perceiving propane</h2>
<p>First we must generate the molecule. The code will compute the molecular graph and subgraphs of all internal coordinates (bonds, angles, etc.), and will try hard to make the SMARTS of each internal coordinate unique. It does this by growing the subgraphs until uniqueness or the entire molecule has been spanned. A depth limit of 0 will cause only the &ldquo;primary&rdquo; atoms of the internal coordinate to be kept; for angles this would be the three atoms.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mol <span style="color:#f92672">=</span> MoleculeGraph<span style="color:#f92672">.</span>from_smiles(<span style="color:#e6db74">&#34;CCC&#34;</span>, protonate<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, depth_limit<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>configure_fields(mol)
</span></span></code></pre></div><p>Now generate the angle environments and print their SMARTS. Here we see that the <code>CCC</code> bond, shown on the first output line, only uses the primary atoms since it is unique compared to the other angles. By default, we do not use hydrogen to establish uniqueness as this information can usually be compressed and captured in the <code>H</code> field. This compression allows much efficient searching on bits rather than using more expensive graph-based algorithms when performing operations on the SMARTS patterns.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>angles <span style="color:#f92672">=</span> mol<span style="color:#f92672">.</span>angles()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> idx, angle <span style="color:#f92672">in</span> angles<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>    smarts <span style="color:#f92672">=</span> angle<span style="color:#f92672">.</span>to_smarts()
</span></span><span style="display:flex;"><span>    print(idx, smarts)
</span></span></code></pre></div><pre><code>(0, 1, 2) [#6:1]-[#6:2]-[#6:3]
(0, 1, 6) [#1:1]-[#6:2](-[#6])-[#6:3]
(0, 1, 7) [#1:1]-[#6:2](-[#6])-[#6:3]
(1, 0, 3) [#1:1]-[#6:2]-[#6:3]-[#6]
(1, 0, 4) [#1:1]-[#6:2]-[#6:3]-[#6]
(1, 0, 5) [#1:1]-[#6:2]-[#6:3]-[#6]
(1, 2, 8) [#1:1]-[#6:2]-[#6:3]-[#6]
(1, 2, 9) [#1:1]-[#6:2]-[#6:3]-[#6]
(1, 2, 10) [#1:1]-[#6:2]-[#6:3]-[#6]
(2, 1, 6) [#1:1]-[#6:2](-[#6])-[#6:3]
(2, 1, 7) [#1:1]-[#6:2](-[#6])-[#6:3]
(3, 0, 4) [#1:1]-[#6:2](-[#1:3])-[#6]-[#6]
(3, 0, 5) [#1:1]-[#6:2](-[#1:3])-[#6]-[#6]
(4, 0, 5) [#1:1]-[#6:2](-[#1:3])-[#6]-[#6]
(6, 1, 7) [#1:1]-[#6:2](-[#6])(-[#6])-[#1:3]
(8, 2, 9) [#1:1]-[#6:2](-[#1:3])-[#6]-[#6]
(8, 2, 10) [#1:1]-[#6:2](-[#1:3])-[#6]-[#6]
(9, 2, 10) [#1:1]-[#6:2](-[#1:3])-[#6]-[#6]
</code></pre>
<p>Since we can define uniqueness in these graphs, we can use a python set to find all of the unique angle SMARTS in propane.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>unique <span style="color:#f92672">=</span> set(angles<span style="color:#f92672">.</span>values())
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> angle <span style="color:#f92672">in</span> unique:
</span></span><span style="display:flex;"><span>    print(angle<span style="color:#f92672">.</span>to_smarts())
</span></span></code></pre></div><pre><code>[#1:1]-[#6:2](-[#6])-[#6:3]
[#6:1]-[#6:2]-[#6:3]
[#1:1]-[#6:2]-[#6:3]-[#6]
[#1:1]-[#6:2](-[#6])(-[#6])-[#1:3]
[#1:1]-[#6:2](-[#1:3])-[#6]-[#6]
</code></pre>
<p>The next step is to aggregate all of the angle environments into a single environment in order to prepare for parameter searching. This is performed by taking the union of the graphs, and by default if two of the graphs are not bijective (every atom in one graph maps to exactly one atom in the other), then only the injective map is kept and unioned (atoms not mapped are dropped). Here, we specify that we want to add unmapped nodes (atoms) which is analogous to graph composition. The resulting SMARTS will be very large and complicated but it will match every unique SMARTS defined above. I call it the &ldquo;branching SMARTS&rdquo; pattern for a reason I give later. The branching SMARTS contains all of the individual SMARTS used to construct it, but using this pattern on propane will match nothing and is therefore not useful as a force field parameter. Conversely, we can also find the &ldquo;most general&rdquo; SMARTS which will actually find all of the propane angles and is therefore useful as a force field parameter. It will be shown below, but for the impatient it is <code>[#1,#6:1]-[#6:2]-[#1,#6:3]</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>group <span style="color:#f92672">=</span> reduce(<span style="color:#66d9ef">lambda</span> x, y: x<span style="color:#f92672">.</span>union(y, add_nodes<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>), angles<span style="color:#f92672">.</span>values())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;group:    </span><span style="color:#e6db74">{</span>group<span style="color:#f92672">.</span>to_smarts()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><pre><code>group:    [#1,#6:1]-[#6:2](-[#6]-[#6])(-[#6])-[#1,#6:3]-[#6]
</code></pre>
<h2 id="part-2-comparing-propane-angles-to-a-force-field-parameter">Part 2: Comparing propane angles to a force field parameter</h2>
<p>Here we create a SMARTS that could be used as a force field parameter. This parameter would match every angle in propane. Below we will start to explore how to search this chemical space to find new parameters based on this parent parameter.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ff_param <span style="color:#f92672">=</span> AngleEnvironment<span style="color:#f92672">.</span>from_smarts(<span style="color:#e6db74">&#34;[*:1][#6:2][*:3]&#34;</span>)
</span></span><span style="display:flex;"><span>configure_fields(ff_param)
</span></span></code></pre></div><p>We use the <code>in</code> keyword to figure out if the parameter would match the group. The intersection of the parameter and the group will drop all atoms that have no mapping between the two, and produce the &ldquo;most general&rdquo; SMARTS. In this case, it will only keep the three primary atoms.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;fitted:   </span><span style="color:#e6db74">{</span>(ff_param <span style="color:#f92672">&amp;</span> group)<span style="color:#f92672">.</span>to_smarts()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;fitted in ff_param? </span><span style="color:#e6db74">{</span>(ff_param <span style="color:#f92672">&amp;</span> group) <span style="color:#f92672">in</span> ff_param<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><pre><code>fitted:   [#1,#6:1]-[#6:2]-[#1,#6:3]
fitted in ff_param? True
</code></pre>
<h2 id="part-3-search-the-chemical-space-of-propane-angles-for-new-parameters">Part 3: Search the chemical space of propane angles for new parameters</h2>
<p>Before jumping in, I will address some confusion in SMARTS patterns when it comes to wildcards, e.g. <code>[*]</code>. Here we define what a wildcard is by specifying what the &ldquo;universe&rdquo; is. In most cases this will be the whatever the dataset contains; here just carbon or hydrogen: <code>[#1,#6]</code>.</p>
<p>The <code>Environment</code>s are graphs with SMARTS information embedded within, so we go to the first (primary) atom and extract the SMARTS information.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>atom <span style="color:#f92672">=</span> reduce(add, mol<span style="color:#f92672">.</span>atoms()<span style="color:#f92672">.</span>values())
</span></span><span style="display:flex;"><span>print(atom<span style="color:#f92672">.</span>to_smarts())
</span></span><span style="display:flex;"><span>ATOM_UNIVERSE <span style="color:#f92672">=</span> atom<span style="color:#f92672">.</span>nodes[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#34;primitive&#34;</span>]
</span></span></code></pre></div><pre><code>[#1,#6:1]-[#6]-[#6]
</code></pre>
<p>Note that the SMARTS here has more than one atom because the reduction creates an <code>AtomEnvironment</code>, which would be equivalent to a vdW parameter. Like angles, vdW environments also work to make each SMARTS pattern as unique as possible*. Here we see that <code>[#1,#6:1]-[#6]-[#6]</code> is the branching SMARTS that would contain all of the <code>AtomEnvironments</code>. The most general here is <code>[#1,#6:1]</code> primarily due to the fact that the methylene carbon is unique and has the SMARTS <code>[#6:1]</code> compared to the two methyl carbons that were spanned to <code>[#6:1][#6][#6]</code> since the code could not distinguish them. This has some subtle issues that are out of scope, but the methlyene carbon environment can be expanded by increasing <code>min_depth</code> during molecule creation. In general, one should set <code>min_depth</code> to the maximum depth the force field parameters are allowed to have.</p>
<p>Now we search the chemical space of the angle parameter by flipping one switch at a time. The code terms these switches &ldquo;bits&rdquo; for an explicit reason. In order to perform all of these operations so far, the SMARTS are encoded as bit vectors and everything shown so far has worked by orchestrating a bunch of standard bitwise operations to give the desired computation. The <code>iter_bits</code> method will go through the graph and produce an <code>AngleEnvironment</code> with just that one bit present (and is definitely not a valid SMARTS!). Because not all bits are useful we only generate bits where there are multiple bits set. For example there is no use in searching something like <code>[#6]</code> but we do want to search something like <code>[#6,#1]</code>. Turning off the carbon in <code>[#6]</code> would lead to an invalid SMARTS, so there is no point to consider it.</p>
<p>The switch can be turned off programmatically in the group by using subtraction, or marginal in set theory.</p>
<p>Note that when we turn off a switch on a parameter that uses a wildcard, we get something like <code>[!#1]</code> for example if the switch is hydrogen. Although perfectly reasonable and technically correct when operating on <code>[*]</code>, it is not very friendly for human consumption. We can get to the heart of the matter by intersecting it with the universe. This will essentially evaluate what <code>[!#1]</code> means which is <code>[#6]</code> in this example. Lastly, it might appear bizarre that the full version produced a bunch of wildcard atoms. The underlying reason is that the switch is embedded in the same graph topology of the group, which is the branching SMARTS, whereas the force field parameter only has a graph of three atoms. When taking marginals, we must consider the fact that SMARTS are substructures and can sometimes possess incomplete information. In addition, SMARTS can also serve as describing molecular fragments, so although the information content in the switches is clear, the graph topology is a little more obtuse and flexible. Thus, we assume that graphs may sometimes have &ldquo;hidden&rdquo; nodes that are either wildcards (all switches) or null (no switches) when performing certain operations. This idea of a single switch potentially being embedded in a graph of arbitrary topology further highlights the complexity of searching chemical space. Here, at least we can see it explicitly and choose to ignore it by just taking some intersections and dropping excess graph topology :)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>full <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>partial <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> switch <span style="color:#f92672">in</span> group<span style="color:#f92672">.</span>iter_bits(skip_ones<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>    specialized <span style="color:#f92672">=</span> ff_param <span style="color:#f92672">-</span> switch
</span></span><span style="display:flex;"><span>    specialized_smarts <span style="color:#f92672">=</span> specialized<span style="color:#f92672">.</span>to_smarts()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fitted <span style="color:#f92672">=</span> ff_param <span style="color:#f92672">&amp;</span> specialized
</span></span><span style="display:flex;"><span>    fitted_smarts <span style="color:#f92672">=</span> fitted<span style="color:#f92672">.</span>to_smarts(atom_universe<span style="color:#f92672">=</span>ATOM_UNIVERSE)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Full: </span><span style="color:#e6db74">{</span>specialized_smarts<span style="color:#e6db74">}</span><span style="color:#e6db74"> &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Fitted: </span><span style="color:#e6db74">{</span>fitted_smarts<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    full<span style="color:#f92672">.</span>add(specialized)
</span></span><span style="display:flex;"><span>    partial<span style="color:#f92672">.</span>add(fitted)
</span></span></code></pre></div><pre><code>Full: [!#1:1]-[#6:2](~[*]~[*])(~[*])-[*:3]~[*] Fitted: [#6:1]-[#6:2]-[#1,#6:3]
Full: [!#6:1]-[#6:2](~[*]~[*])(~[*])-[*:3]~[*] Fitted: [#1:1]-[#6:2]-[#1,#6:3]
Full: [*:1]-[#6:2](~[*]~[*])(~[*])-[!#1:3]~[*] Fitted: [#1,#6:1]-[#6:2]-[#6:3]
Full: [*:1]-[#6:2](~[*]~[*])(~[*])-[!#6:3]~[*] Fitted: [#1,#6:1]-[#6:2]-[#1:3]
</code></pre>
<p>Show only the unique matches on the parameter that matched the same number of atoms, since turning off certain switches will lead to the exact same result.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Unique fitted SMARTS:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> fitted <span style="color:#f92672">in</span> partial:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fitted_smarts <span style="color:#f92672">=</span> fitted<span style="color:#f92672">.</span>to_smarts(atom_universe<span style="color:#f92672">=</span>ATOM_UNIVERSE)
</span></span><span style="display:flex;"><span>    print(fitted_smarts)
</span></span></code></pre></div><pre><code>Unique fitted SMARTS:
[#6:1]-[#6:2]-[#1,#6:3]
[#1:1]-[#6:2]-[#1,#6:3]
</code></pre>
<p>Digesting these results, we see that iterating over a single switch allowed us to learn a few things albeit somewhat complicated at first. This simple example highlights several aspects which make parameter search difficult. First, note that <code>CCH</code> matches either parameter, so order matters. They also define the exact same split, and so even with the simplest case we see that chemical space is fraught with symmetries that can potentially grind our poor python codes to a crawl. An unfortunately large amount of time on my end is identifying these and trying to program around them, but I show them here explicitly for transparency.</p>
<p>Second, we didn&rsquo;t get the nice clean <code>HCH</code> parameter we might have expected; the result was that one parameter has carbon first, and the other has hydrogen. This is explicitly due to the fact that we only searched a single switch, so the new parameters could only distinguish one thing: carbon and hydrogen on one atom. If we want to distinguish <code>HCH</code> from <code>CCC</code>, we need two switches. In my production code, multiple switches are used only in specific scenarios by stacking (unioning) them together, and are used only when the single switch is unable to separate the data. For example, if we have <code>*C*</code> as a parameter that only matches <code>HCH</code> and <code>CCH</code>, then creating a new parameter like <code>*CH</code> would cause all the angles to match the new parameter and the old parameter would be rendered useless. Adding another switch would allow a split in such data to occur. Conversely, there are instances where certain switches do nothing, and all data still lives in the original parameter.</p>
<p>Third, these two new parameters, as they are more &ldquo;specialized&rdquo; than <code>[*:1][#6:2][*:3]</code>, would be put under the parent parameter. If we only take one of these parameters (they communicate the same split), the result would be a force field with two angle parameters. The <code>[*:1][#6:2][*:3]</code> pattern would come first, and <code>[#6:1]-[#6:2]-[#1,#6:3]</code> second. The SMIRNOFF specification says that the last parameter to match is the one that sticks; the lower the parameter is in the force field, the higher priority it has. When applied to propane, <code>CCC</code> and <code>CCH</code> would match the second parameter, and the remaining <code>HCH</code> would match the first, <code>[*:1][#6:2][*:3]</code>. Another aspect of this approach is that the specialized parameter actually matches more chemistry than the more general <code>[*:1][#6:2][*:3]</code> pattern. This means that, using this approach of turning off switches, more specific chemistries are higher up in the hierarchy (less priority) with most chemistry being captured near the bottom (higher priority). Now, let&rsquo;s say that we split the second parameter to <code>[#6:1]-[#6:2]-[#1:3]</code>. Now we have three parameters, three unique angles, but the first angle parameter is still <code>[*:1][#6:2][*:3]</code> and the second is still <code>[#6:1]-[#6:2]-[#1,#6:3]</code>! The point here is that one should always be wary against what a parameter claims to cover, and what it actually covers. Parameter SMARTS in the SMIRNOFF hierarchy do not exist in isolation and their utility is completely determined by where they exist in the hierarchy.</p>
<p>Now, show the same calculation but using the full SMARTS, which will have many additional atoms in the SMARTS. Also, resolve the wildcards and negations using the <code>ATOM_UNIVERSE</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Unique full values:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> specialized <span style="color:#f92672">in</span> full:
</span></span><span style="display:flex;"><span>    specialized_smarts <span style="color:#f92672">=</span> specialized<span style="color:#f92672">.</span>to_smarts(atom_universe<span style="color:#f92672">=</span>ATOM_UNIVERSE)
</span></span><span style="display:flex;"><span>    print(specialized_smarts)
</span></span></code></pre></div><pre><code>Unique full values:
[#1,#6:1]-[#6:2](-[#6]-[#6])(-[#6])-[#6:3]-[#6]
[#6:1]-[#6:2](-[#6]-[#6])(-[#6])-[#1,#6:3]-[#6]
[#1:1]-[#6:2](-[#6]-[#6])(-[#6])-[#1,#6:3]-[#6]
[#1,#6:1]-[#6:2](-[#6]-[#6])(-[#6])-[#1:3]-[#6]
</code></pre>
<p>The main result for the tagged atoms is essentially the same as above, except there are more unique SMARTS because the environments are different. These branching SMARTS have a very specific purpose for finding new parameters which I eluded to earlier. Recall that reducing these into a single <code>AngleEnvironment</code> would produce a branching SMARTS. The atoms that extend beyond the parameter can act as new branch points to explore chemical space with more atoms. For example, recall that the force field parameter has the SMARTS <code>[*:1][#6:2][*:3]</code>. These results indicate that we can possibly specialize this parameter and split it using <code>[*:1][#6:2]([#6])[*:3]</code>, for example. In general, some of the angles may have this added branch, and some may not; branches provide more information to partition the chemistries. Thus, these branching SMARTS allow chemical space exploration and generate force field parameters that perceive beyond the chemistry they currently capture.</p>
<p>Finally, coming back to the idea of only considering one or two switches at a time, complex parameters can be found in two ways with this approach. Since the search space of including multiple bits grows rapidly, it is almost necessary to only consider a few switches at a time. One may in principle try to exhaustively search all switch combinations, but experience has shown me that this might not be necessary. If this doesn&rsquo;t seem like a problem at first glance, consider a torsion that has fifty switches to iterate and we consider four switches. This would be at most <code>50C4 = 230300</code> potential ways to create a new parameter, and additionally noting that the mainline forcefield contains about 100 torsion parameters to consider. The more promising second approach to finding highly specific parameters is by incrementally taking small steps, using only one or two switches at a time. For example, if we search and find a split using only one or two switches, we can repeat the same process and potentially find a split that is now four switches different than the first parameter, which would reduce our space to at most <code>2(50C2) = 2450</code>, since the number of bits in the intermediate parameter could be less than fifty after the first split. We can then delete the intermediate parameter if the data says it is beneficial to do so. Thus, the split that required four switches was found without needing to evaluate all combinations of four switches. Using this approach, we see that it is akin to crossing a river by quickly jumping across it by using a series of stepping stones rather than using time and resources to build a trebuchet to hurl ourselves over in one big &ldquo;jump.&rdquo; In more technical terms, we can potentially make chemical space search effectively polynomial or even linear if we are able to find small, incremental improvements. This potentially shies away from finding a globally optimal solution, but it is a vast improvement over designing parameters by hand.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Chemical space can be navigated using a series of SMARTS switches embedded in a graph topology. The chemical space of propane angles were explored by iterating through the switches. The searches produced patterns that are able specialize existing SMARTS by turning off switches or by adding more atoms to graph, enriching the chemical perception environment. SMARTS patterns can be compared directly by performing bitwise operations, including the ability to explicitly determine SMARTS hierarchy relationships.</p>
<p>Taking the hierarchy idea further, it is possible to explicitly form the SMIRNOFF hierarchy. Below I am showing the hierarchy of the Open Force Field <code>Parsley 1.3.0</code> version. The first level is the root which symbolically represents the file, and the second level contains the parameter handlers. Here the <code>Bonds</code>, <code>Angles</code>, <code>ProperTorsions</code>, <code>ImproperTorsions</code>, and <code>vdW</code> parameters are shown, in order. Next the parameters are then read from the flat list of parameters and rearranged such that the most general parameters are at the top. For example if parameter B is underneath parameter A, then the SMARTS of B is <code>in</code> A, much like <code>[#6:1][#6:2][#1:3]</code> is <code>in</code> <code>[*:1][#6:2][#1:3]</code>. If this is not true, then the parameters are placed side by side on the same level. In order to flatten this hierarchy to represent in the standard XML format, the parameters are visited from top to bottom, left to right.</p>
<p><img src="hierarchy.png" alt="hierarchy" title="Parsley 1.3.0 hierarchy"></p>

			</div>
			
			<div>
				<div id="tags" class="p-y-lg">
					Tags:
					<a href="/tags/force-field">force field</a>
				</div>
			</div>
			
		</article>
	</main>

	<footer>
	
	<div class="footer-left">
		
			
				<div><img src="/images/logo.svg" /></div>
			
		
			
				<div>An open and collaborative approach to better force fields</div>
			
		
	</div>
	<div class="footer-column1">
		
			
				<a href="/about" class="">About</a>
			
		
			
				<a href="/about/organization" class="footer-has-child">Organization</a>
			
		
			
				<a href="/about/roadmap" class="footer-has-child">Roadmap</a>
			
		
			
				<a href="/about/team" class="footer-has-child">Team</a>
			
		
			
				<a href="/about/careers" class="footer-has-child">Careers</a>
			
		
			
				<a href="/about/branding" class="footer-has-child">Branding</a>
			
		
	</div>
	<div class="footer-column2">
		
			
				<a href="/science" class="">Science</a>
			
		
			
				<a href="/science/research" class="footer-has-child">Research</a>
			
		
			
				<a href="/science/publications" class="footer-has-child">Publications</a>
			
		
			
				<a href="/science/collaborative-projects/" class="footer-has-child">Collaborative projects</a>
			
		
			
				<a href="/science//how-to-cite/" class="footer-has-child">How to Cite</a>
			
		
	</div>
	<div class="footer-column3">
		
			
				<a href="/software" class="">Software</a>
			
		
			
				<a href="/data" class="">Data</a>
			
		
			
				<a href="/force-fields" class="">Force Fields</a>
			
		
			
				<a href="/force-fields/force-fields" class="footer-has-child">Force Fields</a>
			
		
			
				<a href="/force-fields/versioning" class="footer-has-child">Versioning</a>
			
		
	</div>
	<div class="footer-column4">
		
			
				<a href="/community" class="">Community</a>
			
		
			
				<a href="/community/news" class="footer-has-child">News</a>
			
		
			
				<a href="/community/events" class="footer-has-child">Events</a>
			
		
			
				<a href="/community/collaborate" class="footer-has-child">Collaborate</a>
			
		
			
				<a href="/community/faq" class="footer-has-child">FAQ</a>
			
		
			
				<a href="/community/forum" class="footer-has-child">Forum</a>
			
		
	</div>
	<div class="footer-right">
		
			
				<div>Follow | Subscribe | Connect</div>
			
		
			
				
				
					<a href="mailto:info@openforcefield.org">
				
				<div class="footer-icon"><svg width="19" height="16" viewBox="0 0 19 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.585 1.59668H2.72386C1.81252 1.59668 1.07373 2.33547 1.07373 3.24681V13.1476C1.07373 14.0589 1.81252 14.7977 2.72386 14.7977H16.585C17.4963 14.7977 18.2351 14.0589 18.2351 13.1476V3.24681C18.2351 2.33547 17.4963 1.59668 16.585 1.59668Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M3.71387 4.23682L9.65434 8.85719L15.5948 4.23682" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://twitter.com/openforcefield">
				
				<div class="footer-icon"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M19.9639 2.31073C19.2404 2.6251 18.4749 2.83221 17.6915 2.92552C18.5148 2.44349 19.1338 1.67768 19.4327 0.771743C18.6544 1.22685 17.8043 1.54617 16.9188 1.71603C16.546 1.32527 16.0976 1.01441 15.6008 0.80234C15.1041 0.590273 14.5694 0.48143 14.0293 0.482429C11.8426 0.482429 10.0729 2.22635 10.0729 4.37611C10.0714 4.67514 10.1057 4.97327 10.175 5.26415C8.60696 5.19064 7.07153 4.79063 5.66693 4.08971C4.26233 3.3888 3.01951 2.40241 2.01796 1.19366C1.6666 1.786 1.48078 2.46184 1.47992 3.15055C1.47992 4.50068 2.18432 5.6941 3.24795 6.39327C2.61778 6.37832 2.00052 6.21153 1.44858 5.90707V5.95528C1.44858 7.84386 2.81478 9.415 4.62299 9.77262C4.28296 9.86327 3.93257 9.90919 3.58066 9.90924C3.33096 9.90968 3.08182 9.88545 2.83688 9.83691C3.33957 11.3839 4.80261 12.5091 6.53568 12.5412C5.12744 13.6265 3.39848 14.2131 1.62056 14.2088C1.30497 14.2083 0.989679 14.1895 0.67627 14.1525C2.48496 15.3074 4.58741 15.9184 6.73338 15.9125C14.0209 15.9125 18.0022 9.97755 18.0022 4.83017C18.0022 4.66141 17.9977 4.49264 17.9897 4.32789C18.7624 3.77822 19.431 3.09514 19.9639 2.31073Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://github.com/openforcefield">
				
				<div class="footer-icon"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M8.98633 0.833008C4.36732 0.833008 0.62207 4.67534 0.62207 9.41011C0.62207 13.2002 3.01933 16.4114 6.34263 17.5466C6.38924 17.5567 6.43682 17.5617 6.48452 17.5615C6.79444 17.5615 6.91393 17.3337 6.91393 17.1358C6.91393 16.9305 6.90647 16.3928 6.90273 15.6758C6.62605 15.7407 6.34301 15.7745 6.05884 15.7766C4.44947 15.7766 4.08353 14.5257 4.08353 14.5257C3.70266 13.5362 3.15375 13.2711 3.15375 13.2711C2.42561 12.7595 3.15002 12.7446 3.20603 12.7446H3.20976C4.04992 12.8193 4.49054 13.6333 4.49054 13.6333C4.90875 14.3652 5.46886 14.5706 5.96922 14.5706C6.30007 14.5639 6.6258 14.4876 6.92514 14.3465C6.99982 13.7939 7.21639 13.4167 7.45537 13.2002C5.59955 12.9836 3.64665 12.248 3.64665 8.96202C3.64665 8.02478 3.97151 7.2593 4.50548 6.66185C4.41959 6.44527 4.13207 5.57151 4.58762 4.39155C4.64873 4.37693 4.71153 4.37065 4.77433 4.37288C5.07678 4.37288 5.76011 4.48864 6.8878 5.27279C8.25802 4.88942 9.70717 4.88942 11.0774 5.27279C12.2051 4.48864 12.8884 4.37288 13.1909 4.37288C13.2537 4.37065 13.3165 4.37693 13.3776 4.39155C13.8331 5.57151 13.5456 6.44527 13.4597 6.66185C13.9937 7.26303 14.3185 8.02851 14.3185 8.96202C14.3185 12.2554 12.3619 12.9799 10.4986 13.1927C10.7973 13.4578 11.0662 13.9806 11.0662 14.7797C11.0662 15.926 11.055 16.8521 11.055 17.1321C11.055 17.3337 11.1707 17.5615 11.4807 17.5615C11.5308 17.5617 11.5809 17.5567 11.63 17.5466C14.9571 16.4114 17.3506 13.1964 17.3506 9.41011C17.3506 4.67534 13.6053 0.833008 8.98633 0.833008Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://zenodo.org/communities/openforcefield/?page=1&amp;size=20">
				
				<div class="footer-icon"><svg width="27" height="10" viewBox="0 0 27 10" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M22.15 7.99361C21.7106 8.91738 21.0047 9.45437 19.972 9.45812C18.9393 9.46188 18.2259 8.9324 17.779 8.01614C17.3809 8.86481 16.7238 9.37926 15.7775 9.45061C14.8312 9.52196 14.1027 9.1164 13.577 8.31655C13.577 8.35035 13.5732 8.37288 13.5732 8.39541C13.5732 8.59444 13.577 8.79721 13.5695 8.99624C13.5619 9.24783 13.3479 9.45812 13.0926 9.46563C12.8184 9.46939 12.6081 9.27788 12.5894 9.01501C12.5856 8.97371 12.5856 8.93616 12.5856 8.89485C12.5856 7.67818 12.5856 6.4615 12.5856 5.24483C12.5856 4.62147 12.1913 4.08073 11.6168 3.91175C10.7343 3.65264 9.87062 4.28727 9.86311 5.20728C9.85936 5.66916 9.86311 6.13105 9.86311 6.59294C9.86311 6.62298 9.86311 6.65677 9.86311 6.69057C8.40611 6.69057 6.95662 6.69057 5.51464 6.69057C5.50713 6.70183 5.49962 6.70559 5.49962 6.70934C5.49211 7.06984 5.46957 7.43034 5.65733 7.76079C5.93146 8.23394 6.33326 8.48554 6.88152 8.47427C7.43352 8.46676 7.83157 8.20014 8.08317 7.71197C8.11696 7.64438 8.15076 7.58054 8.1808 7.50919C8.25966 7.32895 8.3986 7.21629 8.59011 7.21254C9.00694 7.20503 9.42751 7.20878 9.85185 7.20878C9.8556 7.23131 9.85936 7.25384 9.85936 7.27262C9.85936 7.83214 9.86311 8.39166 9.85936 8.95118C9.8556 9.2929 9.5627 9.52196 9.236 9.4431C9.02947 9.39429 8.87926 9.20277 8.87551 8.98873C8.87175 8.76717 8.87551 8.54562 8.87551 8.30153C8.48872 8.90987 7.97427 9.30041 7.27581 9.42057C6.58861 9.54074 5.95774 9.38302 5.39447 8.95118C5.39072 8.98122 5.38696 8.99624 5.3832 9.01501C5.33063 9.24408 5.13912 9.40555 4.90254 9.40931C4.41813 9.41306 3.93747 9.40931 3.45305 9.40931C2.70202 9.40931 1.95474 9.4018 1.20371 9.41306C0.865745 9.41682 0.632925 9.16897 0.644191 8.84979C0.655456 8.3879 0.62166 8.44798 0.903297 8.06871C1.90593 6.71686 2.90855 5.36875 3.91118 4.01689C3.92996 3.99061 3.95249 3.96057 3.98253 3.91926C3.94122 3.91926 3.91494 3.91926 3.8849 3.91926C3.00619 3.91926 2.12372 3.91926 1.24502 3.91926C1.00093 3.91926 0.805663 3.78032 0.741825 3.56252C0.644191 3.23582 0.880766 2.91663 1.23 2.91288C1.57923 2.90912 1.92846 2.91288 2.27769 2.91288C3.06627 2.91288 3.85485 2.92039 4.64719 2.90912C4.99267 2.90537 5.25553 3.10814 5.24426 3.48742C5.86011 2.94292 6.56608 2.74389 7.35466 2.91663C8.15076 3.08937 8.69526 3.58129 9.02571 4.32106C9.47258 3.40105 10.1823 2.86781 11.2187 2.86781C12.2514 2.87157 12.9611 3.40105 13.3967 4.31731C13.8361 3.40105 14.5496 2.86781 15.5822 2.86781C16.6186 2.86781 17.3284 3.4048 17.7715 4.33233C18.0719 3.64513 18.5638 3.17198 19.2848 2.95794C20.0058 2.74389 20.6742 2.87532 21.3126 3.29966C21.3126 3.25835 21.3126 3.23206 21.3126 3.20578C21.3126 2.61997 21.3126 2.03417 21.3126 1.44461C21.3126 1.17048 21.4741 0.975212 21.7332 0.933906C22.0148 0.888844 22.2927 1.11791 22.2927 1.4033C22.2965 2.09801 22.2927 2.79647 22.2927 3.49117C22.2927 3.5137 22.2889 3.53999 22.2777 3.55876C22.1387 3.79158 22.1049 4.05445 22.0824 4.31731C22.0787 4.36237 22.0787 4.40743 22.0862 4.45249C22.1049 4.40368 22.1237 4.35486 22.1462 4.30604C22.4955 3.50619 23.1038 3.02553 23.9637 2.88659C25.2405 2.6763 26.4722 3.59632 26.6412 4.87307C26.6524 4.9707 26.66 5.06834 26.66 5.16973C26.66 5.83064 26.6637 6.49155 26.66 7.15245C26.6524 8.23019 25.9089 9.14644 24.8575 9.39429C23.7685 9.64964 22.6682 9.1164 22.1913 8.10251C22.1913 8.07622 22.1725 8.03867 22.15 7.99361ZM21.3201 6.16485C21.3239 6.16485 21.3239 6.16485 21.3276 6.16485C21.3276 5.86443 21.3314 5.56402 21.3276 5.25985C21.3239 5.13969 21.3201 5.01952 21.2901 4.90311C21.1324 4.21967 20.509 3.79158 19.7955 3.86669C19.1421 3.93428 18.6126 4.52384 18.6089 5.20352C18.6051 5.84941 18.6051 6.4953 18.6089 7.13743C18.6126 7.89973 19.221 8.48929 19.9833 8.47803C20.693 8.46676 21.2713 7.93728 21.3164 7.22756C21.3389 6.87457 21.3201 6.51783 21.3201 6.16485ZM14.2379 6.16485C14.2379 6.49154 14.2341 6.822 14.2379 7.1487C14.2529 8.0612 15.1504 8.69958 16.0178 8.41794C16.5849 8.23394 16.9529 7.72324 16.9529 7.09988C16.9566 6.48028 16.9529 5.86443 16.9529 5.24483C16.9529 5.16597 16.9491 5.09087 16.9378 5.01201C16.8364 4.32857 16.2056 3.81411 15.5259 3.85918C14.7936 3.90799 14.2491 4.46376 14.2379 5.18099C14.2341 5.50769 14.2379 5.83439 14.2379 6.16485ZM25.6911 6.1686C25.6911 5.85692 25.6911 5.54524 25.6911 5.23357C25.6911 5.15471 25.6874 5.07209 25.6723 4.99324C25.5559 4.34735 25.0603 3.90424 24.4069 3.85918C23.6708 3.8066 23.0137 4.38114 22.9761 5.11716C22.9649 5.32369 22.9724 5.53398 22.9724 5.74051C22.9724 6.23244 22.9574 6.72812 22.9799 7.22005C23.0099 7.99736 23.7722 8.59444 24.5383 8.46676C25.2292 8.35035 25.6911 7.80585 25.6911 7.10739C25.6911 6.79196 25.6911 6.48028 25.6911 6.1686ZM1.91719 8.41043C2.91982 8.41043 3.90367 8.41043 4.89879 8.41043C4.88377 8.38415 4.8725 8.36537 4.86124 8.35035C4.62466 7.97108 4.50825 7.55426 4.51201 7.10739C4.51576 6.47652 4.51201 5.84941 4.51201 5.21855C4.51201 5.11716 4.51201 5.01952 4.51201 4.91438C3.65208 6.07472 2.78839 7.23882 1.91719 8.41043ZM8.20709 5.70296C8.20709 5.47014 8.22962 5.24108 8.20333 5.01952C8.13198 4.42621 7.62504 3.93804 7.03923 3.87044C6.41212 3.79534 5.84133 4.12579 5.601 4.69282C5.46206 5.01952 5.51088 5.36124 5.49962 5.70296C6.40836 5.70296 7.3096 5.70296 8.20709 5.70296Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://www.linkedin.com/company/openforcefield/">
				
				<div class="footer-icon"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.345 0.833008H2.38374C1.62087 0.833008 0.954346 1.38191 0.954346 2.13582V16.128C0.954346 16.886 1.62087 17.5615 2.38374 17.5615H16.3409C17.1078 17.5615 17.6829 16.8816 17.6829 16.128V2.13582C17.6873 1.38191 17.1078 0.833008 16.345 0.833008ZM6.13981 14.7771H3.7433V7.32577H6.13981V14.7771ZM5.02446 6.19286H5.00728C4.24031 6.19286 3.74368 5.62192 3.74368 4.90722C3.74368 4.17946 4.25337 3.62197 5.03752 3.62197C5.82167 3.62197 6.3015 4.17535 6.31868 4.90722C6.3183 5.62192 5.82167 6.19286 5.02446 6.19286ZM14.8984 14.7771H12.5019V10.7028C12.5019 9.72676 12.1531 9.05986 11.2861 9.05986C10.6237 9.05986 10.2316 9.50794 10.0572 9.94445C9.99185 10.1013 9.97431 10.3149 9.97431 10.5329V14.7771H7.5778V7.32577H9.97431V8.36271C10.3231 7.86608 10.8679 7.15139 12.1356 7.15139C13.7087 7.15139 14.8988 8.18833 14.8988 10.4239L14.8984 14.7771Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://www.youtube.com/channel/UCh0aJSUm_sYr7nuTzhW806g">
				
				<div class="footer-icon"><svg width="22" height="17" viewBox="0 0 22 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M21.3762 3.78816C21.3762 1.93759 20.015 0.448904 18.3331 0.448904C16.0548 0.342393 13.7313 0.30127 11.3568 0.30127H10.6166C8.24785 0.30127 5.92024 0.342393 3.64198 0.449315C1.96412 0.449315 0.602924 1.94622 0.602924 3.7968C0.500114 5.2604 0.456523 6.72441 0.45899 8.18842C0.454878 9.65242 0.501485 11.1178 0.598811 12.5846C0.598811 14.4351 1.96001 15.9362 3.63786 15.9362C6.03127 16.0472 8.48637 16.0965 10.9826 16.0924C13.4829 16.1006 15.9312 16.0486 18.3273 15.9362C20.0093 15.9362 21.3705 14.4351 21.3705 12.5846C21.4692 11.1164 21.5144 9.65242 21.5103 8.1843C21.5196 6.72029 21.4749 5.25491 21.3762 3.78816ZM8.97163 12.2227V4.14183L14.9346 8.18019L8.97163 12.2227Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="http://eepurl.com/gYuojL">
				
				<div class="footer-icon"><svg width="19" height="21" viewBox="0 0 19 21" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.0794 9.62959C14.2146 9.62959 14.3498 9.62959 14.485 9.62959C14.5711 9.44519 14.5711 9.17475 14.485 8.86743C14.399 8.4126 14.2638 8.10528 13.9933 8.14215C13.7229 8.19133 13.7229 8.54782 13.8089 9.00265C13.8458 9.27309 13.9442 9.49437 14.0794 9.62959Z" fill="white"/>
<path d="M11.6945 10.0353C11.8789 10.1214 12.0141 10.1706 12.051 10.1214C12.1001 10.0722 12.051 10.0353 12.0018 9.93699C11.9157 9.7526 11.6822 9.61738 11.5101 9.53133C11.0552 9.34694 10.5635 9.39611 10.1579 9.71572C10.0226 9.80177 9.88742 9.93699 9.93659 10.0353C9.93659 10.0845 9.98576 10.0845 10.0226 10.0845C10.1087 10.0845 10.5144 9.90011 10.9692 9.86323C11.2396 9.85094 11.5101 9.94928 11.6945 10.0353Z" fill="white"/>
<path d="M11.2888 10.2562C11.0184 10.3053 10.8831 10.3914 10.7971 10.4774C10.711 10.5635 10.6619 10.6126 10.6619 10.6618V10.711H10.711C10.7602 10.711 10.8954 10.6618 10.8954 10.6618C11.2519 10.5266 11.4855 10.5266 11.7068 10.5758C11.842 10.5758 11.8911 10.6249 11.928 10.5758C11.928 10.5758 11.928 10.5266 11.928 10.4897C11.9157 10.3545 11.6453 10.2193 11.2888 10.2562Z" fill="white"/>
<path d="M11.4241 10.5758C11.5102 10.3914 11.5102 9.98572 11.4241 9.6784C11.3381 9.22357 11.2028 8.95312 10.8832 8.95312C10.6128 9.0023 10.6128 9.35879 10.6988 9.8505C10.748 10.1701 10.8832 10.3422 10.9201 10.4774C11.1537 10.8462 11.2889 10.7479 11.4241 10.5758Z" fill="white"/>
<path d="M13.268 11.0678C13.4524 11.1538 13.6245 11.117 13.7228 10.9817C13.772 10.8465 13.6736 10.6621 13.5015 10.5761C13.3171 10.49 13.145 10.5269 13.0467 10.6621C12.9484 10.7973 13.0836 10.9817 13.268 11.0678Z" fill="white"/>
<path d="M14.3867 10.084C14.2514 10.084 14.1162 10.2192 14.1162 10.4405C14.1162 10.6249 14.2023 10.797 14.3867 10.797C14.5219 10.797 14.6571 10.6617 14.6571 10.4405C14.6202 10.2561 14.5219 10.084 14.3867 10.084Z" fill="white"/>
<path d="M4.85982 13.5878C4.81064 13.5386 4.77377 13.5386 4.7246 13.5878C4.67542 13.5878 4.63855 13.5878 4.58937 13.5878C4.50332 13.5878 4.40498 13.5386 4.3681 13.4525C4.33122 13.3665 4.31893 13.2313 4.3681 13.0469L4.41727 12.9608C4.5525 12.6904 4.73689 12.2847 4.50332 11.8791C4.31893 11.5594 4.09766 11.3873 3.77805 11.3382C3.45843 11.289 3.15111 11.4242 2.96672 11.6578C2.64711 12.0143 2.61023 12.4691 2.64711 12.6412C2.64711 12.6904 2.69628 12.7273 2.73316 12.7273C2.78233 12.7273 2.86838 12.6781 2.91755 12.5429V12.4937C2.91755 12.4076 2.96672 12.3093 3.05277 12.1741C3.13882 12.0389 3.27404 11.9528 3.40926 11.9528C3.54448 11.9036 3.72888 11.9528 3.8641 12.0389C4.08537 12.1741 4.18371 12.4445 4.08537 12.715C3.95015 12.8502 3.90098 13.0715 3.90098 13.305C3.95015 13.7107 4.22059 13.8951 4.44186 13.932C4.66313 13.932 4.84752 13.7967 4.84752 13.7107C4.89669 13.6369 4.85982 13.6369 4.85982 13.5878Z" fill="white"/>
<path d="M17.9393 12.8256C17.9393 12.7764 17.8901 12.6043 17.8041 12.3339L17.6197 11.9282C17.9393 11.4734 17.9393 11.0308 17.8901 10.8096C17.8409 10.5391 17.7057 10.2687 17.4845 9.99822C17.2632 9.72778 16.7223 9.45734 16.0462 9.27295L15.6897 9.1869C15.6897 9.1869 15.6897 8.3264 15.6405 7.96991C15.6405 7.69947 15.5914 7.29381 15.4561 6.88814C15.3209 6.34726 15.0505 5.85555 14.694 5.53593C15.5914 4.58939 16.1814 3.50761 16.1814 2.61024C16.1814 0.901538 14.0671 0.360654 11.4118 1.44242L10.8709 1.66369C10.8709 1.66369 9.88749 0.680267 9.83832 0.680267C6.92492 -1.92581 -2.38074 8.46162 0.58183 10.9816L1.20876 11.5225C1.02437 11.9774 0.987493 12.4691 1.02437 13.01C1.11042 13.6861 1.47921 14.3622 2.0078 14.9031C2.54868 15.3948 3.26166 15.7144 3.98694 15.7144C5.15476 18.4188 7.81001 20.0292 10.9078 20.1275C14.2392 20.2136 17.0665 18.6401 18.2343 15.8496C18.3204 15.6652 18.64 14.7678 18.64 13.9565C18.7137 13.1329 18.2589 12.8256 17.9393 12.8256ZM4.26968 14.9399C4.18363 14.9399 4.0484 14.9891 3.95006 14.9399C2.96664 14.8908 1.8357 13.9934 1.74965 12.9116C1.6636 11.7438 2.24136 10.8464 3.32313 10.6129C3.45835 10.5637 3.59357 10.5637 3.77796 10.5637C4.36802 10.6129 5.26539 11.0554 5.48666 12.3584C5.65876 13.5877 5.40061 14.7555 4.26968 14.9399ZM3.15103 9.89988C2.47492 10.0351 1.89716 10.3916 1.52838 10.9325C1.30711 10.7481 0.901443 10.3916 0.852272 10.2564C0.262217 9.17461 1.47921 7.02336 2.3397 5.84325C4.4049 2.88068 7.68708 0.631096 9.17451 1.02447C9.44495 1.11052 10.2563 2.05706 10.2563 2.05706C10.2563 2.05706 8.73197 2.91756 7.33059 4.08538C5.43749 5.48676 3.99923 7.60113 3.15103 9.89988ZM13.7597 14.4851L13.8089 14.4359C13.8089 14.3868 13.7597 14.3868 13.7597 14.3868C13.7597 14.3868 12.1863 14.608 10.6988 14.0671C10.8832 13.5263 11.2889 13.7107 11.9527 13.7967C13.1205 13.8828 14.2023 13.7107 14.9644 13.4771C15.6405 13.2927 16.5379 12.887 17.214 12.3584C17.4353 12.8502 17.5336 13.4402 17.5336 13.4402C17.5336 13.4402 17.718 13.391 17.8532 13.4894C17.9885 13.5754 18.0745 13.7598 18.0376 14.2147C17.9024 15.112 17.4967 15.7881 16.919 16.4642C16.5625 16.8699 16.0585 17.2264 15.5299 17.4968C15.2595 17.6321 14.9398 17.7673 14.6325 17.8533C12.1985 18.6155 9.77686 17.8042 9.0147 15.9602C8.96553 15.825 8.87948 15.6898 8.87948 15.5054C8.55987 14.2884 8.83031 12.8502 9.73998 11.9528C9.78915 11.9036 9.82603 11.8176 9.82603 11.7315C9.82603 11.6455 9.77686 11.5963 9.73998 11.5471C9.42037 11.0923 8.35089 10.3301 8.57216 8.8427C8.70738 7.76093 9.65393 7.04795 10.5021 7.08482H10.7234C11.0799 7.08482 11.4487 7.17088 11.7068 7.17088C12.1985 7.17088 12.6903 7.1217 13.2311 6.67916C13.4155 6.54394 13.5508 6.40872 13.8212 6.35955C13.8704 6.35955 13.9072 6.31038 14.0425 6.35955C14.1777 6.35955 14.3129 6.40872 14.399 6.49477C14.8538 6.81438 14.8907 7.4782 14.9398 8.01908C14.9398 8.33869 14.989 9.05168 14.989 9.23607C15.0382 9.6909 15.1242 9.77695 15.3947 9.863C15.5299 9.91217 15.6651 9.94905 15.8495 9.99822C16.4396 10.1826 16.7961 10.3178 17.0173 10.5391C17.1525 10.6743 17.2017 10.8096 17.2386 10.9448C17.3246 11.4365 16.8329 12.0634 15.6159 12.6535C14.2637 13.2804 12.6903 13.4156 11.5716 13.2804L11.1659 13.2312C10.2686 13.096 9.77686 14.2638 10.3054 15.026C10.6619 15.5177 11.6085 15.8865 12.5059 15.8865C14.6694 15.8865 16.3289 14.9891 16.919 14.1778L16.9682 14.0917C17.0173 14.0426 16.9682 14.0057 16.919 14.0426C16.4273 14.3991 14.1777 15.7513 11.7929 15.3456C11.7929 15.3456 11.5224 15.2964 11.252 15.2104C11.0307 15.1243 10.6251 14.9399 10.5267 14.4851C12.5427 15.0752 13.7597 14.4851 13.7597 14.4851ZM7.01097 5.85554C7.73625 4.99505 8.6705 4.23289 9.48183 3.82723C9.531 3.82723 9.531 3.82723 9.531 3.8764C9.48183 4.01162 9.34661 4.23289 9.30973 4.41728C9.30973 4.46646 9.3589 4.46646 9.3589 4.46646C9.85061 4.10996 10.748 3.74118 11.5224 3.7043C11.5716 3.7043 11.5716 3.75347 11.5716 3.75347C11.4364 3.83952 11.3503 3.97474 11.2151 4.10996C11.2151 4.10996 11.2151 4.15914 11.2643 4.15914C11.8052 4.15914 12.5673 4.34353 13.059 4.65085C13.1082 4.65085 13.059 4.7369 13.0099 4.7369C12.2477 4.55251 11.0307 4.41729 9.72769 4.7369C8.55987 5.00734 7.69937 5.46218 7.07244 5.90472C7.01097 5.89242 6.9741 5.89242 7.01097 5.85554Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
		<div><br />Content licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0.</a><br />Website by <a href="https://www.vanleeuwenvanleeuwen.nl/">van Leeuwen & van Leeuwen</a><br />and the Open Force Field Initiative.</div>
	</div>
</footer>

</body>
</html>

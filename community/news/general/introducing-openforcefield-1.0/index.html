<!DOCTYPE html>
<html lang="en-us">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.0/es5/tex-mml-chtml.min.js" integrity="sha512-ARgWTEVpGUlOMJL4bRTZtbFUs3LjpPC0YTRJc5FC1KVT18OTBb18Jowb6Is185zStFYyfUJhDgiHVzvt8w+8pg==" crossorigin="anonymous"></script>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="icon" type="image/png" href="https://openforcefield.org/favicon/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://openforcefield.org/favicon/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://openforcefield.org/favicon/favicon-32x32.png">
  <link rel="icon" type="image/ico" href="https://openforcefield.org/favicon/favicon.ico">
	<link rel="manifest" href="https://openforcefield.org/site.webmanifest">
	<title>The Open Force Field 1.0 small molecule force field, our first optimized force field (codename &#34;Parsley&#34;)</title>
	
	
	
	<link rel="stylesheet" href="https://openforcefield.org/sass/index.min.d78ed623887aea8d388ea2b269ff6bd6f793863913d7532af625373655e478c5.css">
	
	
	<script type="text/javascript" src="https://openforcefield.org/js/jquery.min.js"></script>
	
	<script type="text/javascript" src="https://openforcefield.org/js/script.min.js"></script>
</head>
<body class="" data-color="default">
	



<div class="menu-button"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
  <path d="M1 3v2h18V3zm0 8h18V9H1zm0 6h18v-2H1z"/>
</svg>
</div>
<header>
	<a href="https://openforcefield.org/" class="logo"><img src="/img/icon.svg" /></a>
	
		<nav>
			<ul>
				<li>
					<a href="https://openforcefield.org/" class="menu-home">Home</a>
				</li>
				
					
					
					<li class=""><a data-menu="about" href="https://openforcefield.org/about/organization/">About</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu " data-submenu="about">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/about/organization/" class="">Organization</a></li>
										
											<li><a href="https://openforcefield.org/about/roadmap/" class="">Roadmap</a></li>
										
											<li><a href="https://openforcefield.org/about/team/" class="">Team</a></li>
										
											<li><a href="https://openforcefield.org/about/careers/openff/" class="">Careers</a></li>
										
											<li><a href="https://openforcefield.org/about/branding/" class="">Branding</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
					<li class=""><a data-menu="science" href="https://openforcefield.org/science/research">Science</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu " data-submenu="science">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/science/research/" class="">Research</a></li>
										
											<li><a href="https://openforcefield.org/science/publications/" class="">Publications</a></li>
										
											<li><a href="https://openforcefield.org/science/collaborative-projects/" class="">Collaborative projects</a></li>
										
											<li><a href="https://openforcefield.org/science/how-to-cite/" class="">How to cite</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
					<li class=""><a data-menu="software" href="https://openforcefield.org/software">Software</a></li>
					
				
					
					
					<li class=""><a data-menu="data" href="https://openforcefield.org/data">Data</a></li>
					
				
					
					
					<li class=""><a data-menu="force-fields" href="https://openforcefield.org/force-fields/force-fields/">Force Fields</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu " data-submenu="force-fields">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/force-fields/force-fields/" class="">Force Fields</a></li>
										
											<li><a href="https://openforcefield.org/force-fields/versioning/" class="">Versioning</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
						
					
					<li class="active"><a data-menu="community" href="https://openforcefield.org/community/news/general/">Community</a></li>
					
						<div class="submenus-mobile">
							<div class="submenu active" data-submenu="community">
								<nav>
									<ul>
										
											<li><a href="https://openforcefield.org/community/news/general/" class="">News</a></li>
										
											<li><a href="https://openforcefield.org/community/events/webinars/" class="">Events</a></li>
										
											<li><a href="https://openforcefield.org/community/collaborate" class="">Collaborate</a></li>
										
											<li><a href="https://openforcefield.org/community/faq/" class="">FAQ</a></li>
										
											<li><a href="https://discourse.openforcefield.org/" class="">Forum</a></li>
										
									</ul>
								</nav>
							</div>
						</div>
					
				
					
					
					<li class=""><a data-menu="how-to-join" href="https://openforcefield.org/how-to-join">How to join</a></li>
					
				
			</ul>
		</nav>
	
	<div class="search-button" style="display: none">
		<img src="/img/search.svg" />
	</div>
</header>
<div class="menu-back"></div>
<div class="submenus active">
	
		
			<div class="submenu " data-submenu="about">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/about/organization/" class="">Organization</a></li>
						
							<li><a href="https://openforcefield.org/about/roadmap/" class="">Roadmap</a></li>
						
							<li><a href="https://openforcefield.org/about/team/" class="">Team</a></li>
						
							<li><a href="https://openforcefield.org/about/careers/openff/" class="">Careers</a></li>
						
							<li><a href="https://openforcefield.org/about/branding/" class="">Branding</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
			<div class="submenu " data-submenu="science">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/science/research/" class="">Research</a></li>
						
							<li><a href="https://openforcefield.org/science/publications/" class="">Publications</a></li>
						
							<li><a href="https://openforcefield.org/science/collaborative-projects/" class="">Collaborative projects</a></li>
						
							<li><a href="https://openforcefield.org/science/how-to-cite/" class="">How to cite</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
	
		
	
		
			<div class="submenu " data-submenu="force-fields">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/force-fields/force-fields/" class="">Force Fields</a></li>
						
							<li><a href="https://openforcefield.org/force-fields/versioning/" class="">Versioning</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
			<div class="submenu active" data-submenu="community">
				<nav>
					<ul>
						
							<li><a href="https://openforcefield.org/community/news/general/" class="">News</a></li>
						
							<li><a href="https://openforcefield.org/community/events/webinars/" class="">Events</a></li>
						
							<li><a href="https://openforcefield.org/community/collaborate" class="">Collaborate</a></li>
						
							<li><a href="https://openforcefield.org/community/faq/" class="">FAQ</a></li>
						
							<li><a href="https://discourse.openforcefield.org/" class="">Forum</a></li>
						
					</ul>
				</nav>
			</div>
		
	
		
	
</div>

	<div class="subheader">
		<h1><b>open</b> force field</h1>
		<h3>An open and collaborative approach to better force fields</h3>
		
		

		
		
		
		
	</div>


	
		
	
	
		
		
				
	
	
		
		
				
	
	
		
		
			
				
					
				
			
				
					
				
			
			
				<div class="subheader-menu">
					<div>
						
							
								
							
							
								<div>
									<b><a href="https://openforcefield.org/community/news/general/" class="">News</a></b>
								</div>
							
						
							
								
							
							
								<div>
									<b><a href="https://openforcefield.org/community/news/science-updates/" class="">Science Updates</a></b>
								</div>
							
						
					</div>
				</div>
			
		
	

		
	

		
	

	<main class="single">
		<article>
			<h1>The Open Force Field 1.0 small molecule force field, our first optimized force field (codename &#34;Parsley&#34;)</h1>
			
				<h6>
			
			
				Posted on 10 Oct 2019
			
			
				by David Mobley, Yudong Qiu, Simon Boothroyd, Lee-Ping Wang, and John Chodera
			
			
				</h6>
			
			<div>
				<!-- Parsley CC0 image from https://www.maxpixel.net/Leaf-Plant-Parsley-Common-Aromatic-Parsley-Leaves-3327372 -->
<center>
<img src="noun_parsley.svg" width="40%">
</center>
<p>We’re delighted to announce the release of &ldquo;Parsley&rdquo;, the <a href="https://github.com/openforcefield/openforcefields/releases/tag/1.0.0">Open Force Field 1.0 small molecule force field</a>&mdash;the first in a series of iteratively-improved small molecule force fields for biomolecular simulation funded in part by the <a href="http://openforcefield.org/consortium">Open Force Field Consortium</a>.
This is the first optimized force field to use the <a href="https://open-forcefield-toolkit.readthedocs.io/en/latest/smirnoff.html">SMIRNOFF force field specification</a> for atom type-free <a href="https://dx.doi.org/10.1021/acs.jctc.8b00640">direct chemical perception</a>, and provides substantially improved valence (bond, angle, and torsion) parameters relative to its predecessor, the AMBER-lineage <a href="https://dx.doi.org/10.1021/acs.jctc.8b00640">SMIRNOFF99Frosst</a>.
This force field was optimized to improve agreement with quantum chemical geometries, energetics, and vibrational frequencies, and will likely provide improved accuracy (relative to its predecessor) for a wide variety of properties, especially energetics and geometries relative to gas phase quantum chemical calculations</p>
<p>In this release, we retained the typing/chemical perception tree from <a href="https://github.com/openforcefield/smirnoff99Frosst/releases/tag/1.1.0">SMIRNOFF99Frosst 1.1.0</a>, but optimized nearly all (481/500) valence parameters, retaining the toolkit-based <a href="https://doi.org/10.1002/jcc.10128">AM1-BCC</a> charge model and Lennard-Jones parameters of its predecessor.
<a href="https://github.com/openforcefield/smirnoff99Frosst">SMIRNOFF99Frosst</a> was a manually-curated direct descendent of the older <a href="http://www.ccl.net/cca/data/parm_at_Frosst/">parm@Frosst</a> small molecule force field, adapted for the SMIRNOFF specification without parameter refitting.
By optimizing the vast majority of parameters, we have produced a substantially new force field which is better supported by quantum chemical calculations.</p>
<p>Initial benchmarking focused on two major aspects: (1) Accuracy relative to quantum chemical calculations on a test set of molecules, and (2) accuracy on condensed phase properties for a diverse set of molecules.
Quantum chemical benchmarks covered a set of more than 2000 molecules, examining the quality of optimized geometries and relative conformer energies.
Performance improved substantially relative to <a href="https://github.com/openforcefield/smirnoff99Frosst">SMIRNOFF99Frosst</a>.
On condensed-phase properties (density, dielectric constant, heat of vaporization, excess molar volume and enthalpy of mixing), no dramatic performance differences were noted in this release as expected, since valence parameters typically play a relatively minor role in these properties.
Performance on condensed-phase properties was comparable to GAFF.</p>
<p>To enable this improved force field to be of immediate use to the community, we provide a brief overview of the automated fitting procedure, the curation of training and benchmark datasets, and initial benchmarks.
The <a href="http://openforcefield.org">Open Force Field Initiative</a> aims to provide not only new biomolecular force fields, but also open source  automated parameterization infrastructure, along with versioned, curated datasets to advance biomolecular force field science.
We have released all datasets and open source code for the community to reproduce and build on everything we have done to produce this force field. Complete details will be provided in a forthcoming paper that builds upon the initial overview reported in this blog post.</p>
<h2 id="major-contributors">Major contributors</h2>
<p>Many individuals form the <a href="http://openforcefield.org/members">Open Force Field Initiative</a> contributed to the construction of data sets, infrastructure, parameterization, and benchmarks for this first force field release. We would like to thank to our entire team for their hard work, our industry partners for their support and helpful feedback, and many others who have joined numerous scientific discussions which  preceded this release.</p>
<p>The following scientists made particularly crucial contributions to the development of Parsley:</p>
<ul>
<li><a href="https://orcid.org/0000-0003-4345-8356">Yudong Qiu</a> (UC Davis)</li>
<li><a href="https://orcid.org/0000-0001-8626-0900">Daniel G. A. Smith</a> (MolSSI)</li>
<li><a href="https://orcid.org/0000-0002-3456-1872">Simon Boothroyd</a> (MSKCC)</li>
<li><a href="https://orcid.org/0000-0001-6448-0873">Jeffrey Wagner</a> (UC Irvine)</li>
<li><a href="https://orcid.org/0000-0003-2777-1174">Caitlin C. Bannan</a> (UC Irvine)</li>
<li><a href="https://orcid.org/0000-0001-7856-1156">Trevor Gokey</a> (UC Irvine)</li>
<li><a href="https://orcid.org/0000-0002-1697-2918">Hyesu Jang</a> (UC Davis)</li>
<li><a href="https://orcid.org/0000-0003-4030-9312">Victoria T. Lim</a> (UC Irvine)</li>
<li><a href="https://orcid.org/0000-0001-6200-3993">Chaya Stern</a> (MSKCC)</li>
<li><a href="https://orcid.org/0000-0001-7693-2013">Andrea Rizzi</a> (MSKCC)</li>
<li><a href="https://orcid.org/0000-0003-0887-3976">Xavier Lucas</a> (F. Hoffmann-La Roche AG)</li>
<li>Bryon Tjanaka (UC Irvine)</li>
<li><a href="https://orcid.org/0000-0003-3249-1097">Michael R. Shirts</a> (CU Boulder)</li>
<li><a href="https://orcid.org/0000-0002-3375-1738">Michael K. Gilson</a> (UC San Diego)</li>
<li><a href="https://orcid.org/0000-0003-0542-119X">John D. Chodera</a> (MSKCC)</li>
<li><a href="https://orcid.org/0000-0001-9145-6457">Christopher I. Bayly</a> (OpenEye Scientific Inc.)</li>
<li><a href="https://orcid.org/0000-0002-1083-5533">David L. Mobley</a> (UC Irvine)</li>
<li><a href="https://orcid.org/0000-0003-3072-9946">Lee-Ping Wang</a> (UC Davis)</li>
</ul>
<br>
## Table of Contents
<ul>
<li><a href="#using-parsley">Using Parsley</a></li>
<li><a href="#citing-parsley">Citing Parsley</a></li>
<li><a href="#fitting-with-forcebalance">Fitting force fields with ForceBalance</a></li>
<li><a href="#fitting-parsley-to-quantum-chemical-data">Fitting Parsley to quantum chemical data</a>
<ul>
<li><a href="#optimization-datasets">Optimized energies and geometries</a></li>
<li><a href="#torsion-datasets">Torsion drives</a></li>
</ul>
</li>
<li><a href="#fitting-results">Optimizing parameters in Parsley</a></li>
<li><a href="#benchmarking-parsley">Benchmarking Parsley</a>
<ul>
<li><a href="#quantum-chemical-benchmarks">Quantum chemical benchmarks</a></li>
<li><a href="#physical-property-benchmarks">Physical property benchmarks</a></li>
</ul>
</li>
<li><a href="#future-plans">Plans for additional benchmarks</a></li>
</ul>
<br>
<a id="using-parsley"></a>
## Using Parsley
<p>The Parsley force field is officially known as <code>openff-1.0.0.offxml</code> in our force field package, <a href="https://github.com/openforcefield/openforcefields/"><code>openforcefields</code></a>. Two versions of this file are being released &ndash; One with hydrogen bond length constraints which allow for typical 2 fs timesteps to be taken in simulations (or longer timesteps if suitable algorithms are utilized), and another without the constraints, which is suitable for geometry optimizations and single-point energy calculation.</p>
<p>Using <code>conda</code>, users can gain access to the Open Force Field Toolkit and the new force fields by running <code>conda install -c omnia openforcefield openforcefields</code>. Once installed, the Open Force Field Toolkit will be able to find and load the new file using the ForceField constructor:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> openforcefield.typing.engines.smirnoff <span style="color:#f92672">import</span> ForceField
</span></span><span style="display:flex;"><span>ff <span style="color:#f92672">=</span> ForceField(<span style="color:#e6db74">&#39;openff-1.0.0.offxml&#39;</span>)
</span></span></code></pre></div><p>To use  a version of the force field without bond constraints to hydrogens for comparison to quantum chemical geometries:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ff <span style="color:#f92672">=</span> ForceField(<span style="color:#e6db74">&#39;openff_unconstrained-1.0.0.offxml&#39;</span>)
</span></span></code></pre></div><p>To see an example of how to use the Parsley force field to run a molecular dynamics simulation, consider downloading and running our <a href="https://github.com/openforcefield/openforcefield/tree/master/examples">example Jupyter notebooks</a>.
Alternatively, the force field files themselves can be found under the <code>openforcefields/offxml</code> subdirectory of <a href="https://github.com/openforcefield/openforcefields">the openforcefields GitHub repository</a>
This specific force field also has a DOI on Zenodo, which can be used when citing it in scholarly work: <a href="https://doi.org/10.5281/zenodo.3483227"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.3483227.svg" alt="DOI"></a></p>
<br>
<a id="citing-parsley"></a>
## Citing Parsley
<p>We recommend that this force field be referred to as the “Open Force Field v.1.0.0 – Parsley” on first reference, and OpenFF 1.0.0 or “Parsley” thereafter. Bug fix/patch releases in the OpenFF 1.0 series will also be referred to as Parsley, while major versions will receive updated codenames.</p>
<p>To cite Parsley, please cite the DOI for the force field version you use (available in the <code>openforcefields</code> <a href="https://github.com/openforcefield/openforcefields/releases">repository</a>). Our latest force field release DOI is available <a href="https://zenodo.org/badge/latestdoi/206618274">here</a>. The full reference should include a force field DOI and a publication record. The latter refers to our preprint/paper once available, but in the meantime, please use <a href="https://doi.org/10.5281/zenodo.3963295">Zenodo DOI assigned to this blog post</a> as a source of additional information. You can export citation reference by clicking on a preferred format in the bottom right page corner of the relevant Zenodo record (force field + blog post). We will update this post once a preprint and peer-reviewed publications become available.</p>
<br>
<a id="fitting-force-fields-with-forcebalance"></a>
## Fitting force fields with ForceBalance
<p>We used <a href="https://doi.org/10.1021/jz500737m">ForceBalance</a> to fit the parameters in Parsley.
Before discussing the data used in fitting and the actual fitting process, we briefly introduce ForceBalance.
<a href="https://github.com/leeping/forcebalance">ForceBalance</a> is a Python toolkit designed for carrying out force field optimizations in a systematic, reproducible, scalable and flexible way. Here, we employed a development version of ForceBalance based on v1.6.0 (available <a href="https://github.com/leeping/forcebalance/tree/5b3a65d1baefe17625c9b05c0db5d27458c5344a">here</a>) to fit a SMIRNOFF force field to the optimized geometries, torsional profiles and vibrational frequencies using the objective function as described below.</p>
<p><a id="regularized-force-field-optimization"></a></p>
<h3 id="regularized-force-field-optimization-with-quasi-newton-iterations">Regularized force field optimization with quasi-Newton iterations</h3>
<p>To determine the parameters for Parsley, we aimed to optimize force field parameters $$\theta$$ to minimize a loss function $$L(\theta)$$ that quantifies deviation from quantum chemical data while adding a regularization penalty to minimize the deviation from a reference set of parameters, following the standard approach for <a href="https://doi.org/10.1021/jz500737m">parameter fitting with ForceBalance</a>:</p>
<p>$$L_\mathrm{tot}(\theta) = \sum_{i \in \mathrm{targets}} w_i L_i(\theta) +  w_{reg} \sum_{p \in \mathrm{parameters}} \frac{1}{2} \frac{|\Delta \theta_p|}{\sigma_p^2}^2$$</p>
<p>Here, $$w_i$$ is the weight of each class of optimization data targets with corresponding loss functions $$L_i(\theta)$$, which are often least-squares penalized loss:</p>
<p>$$L_i(\theta) = \sum_{j \in \mathrm{data}} \frac{1}{2} \left( A_j^\mathrm{obs} - A_j^\mathrm{calc}(\theta) \right)^2$$</p>
<p>where $$A_j^\mathrm{obs}$$ is an observed quantum chemical or physical property target to fit, and $$A_j^\mathrm{calc}(\theta)$$ is the calculated value.</p>
<p>$$w_{reg}$$ is the regularization penalty weight, and $$\Delta \theta$$ quantifies the deviation from a reference set of parameters (here, the initial parameter set).</p>
<p>To efficiently optimize the parameters in as few iterations as possible, ForceBalance uses a quasi-Newton iteration to take near-optimal steps in parameter space:</p>
<p>$$\theta^{(n+1)} = \theta^{(n)} + \left[ \mathbf{H}(\theta) + \lambda \mathbf{I} \right]^{-1}$$</p>
<p>To approximate the Hessian $$\mathbf{H}(\theta)$$, ForceBalance computes an approximate to the the matrix of second derivatives of each least-squares component in a manner that neglects parameter couplings:</p>
<p>$$H_{i, pq}(\theta) = \frac{\partial^2}{\partial \theta_p \partial \theta_q} L_i(\theta) = \sum_{j \in \mathrm{data}}\frac{\partial A_j}{\partial \theta_p} \frac{\partial A_j}{\partial \theta_q} + \frac{\partial^2 A_j}{\partial \theta_p \partial \theta_q} \approx \sum_{j \in \mathrm{data}}\frac{\partial A_j}{\partial \theta_p} \frac{\partial A_j}{\partial \theta_q}$$</p>
<p>The $$\lambda$$ parameter is used to restrict the optimization step to lie within a trust radius (which is adjusted on-the-fly based on step quality).
In the fitting of bonded parameters (stage 1 and 3), we performed line-search minimization on $$\lambda$$ to determine the next step, for improved convergence behavior.</p>
<p><a id="parameter-regularization"></a></p>
<h3 id="parameter-regularization">Parameter regularization</h3>
<p>Regularization is important to ensure that parameter adjustments are made conservatively to avoid introducing large problematic parameter changes that may only provide marginal improvements in the optimization target, especially when smaller datasets are used in parameterization.
Internally, <a href="https://doi.org/10.1021/jz500737m">ForceBalance</a> converts parameters into a dimensionless &ldquo;mathematical&rdquo; representation using user-specified scaling factors, and works with these dimensionless parameters internally.
To penalize deviations from a reference set of parameters&mdash;here, the <a href="https://github.com/openforcefield/smirnoff99Frosst/releases/tag/1.1.0">SMIRNOFF99Frosst 1.1.0</a> parameters&mdash;we used the following regularization scales $$\sigma_p$$:</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Parameter</strong></th>
<th style="text-align:left"><strong>Regularization scale $$\sigma_p$$</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">bond force constant $$K_r$$</td>
<td style="text-align:left">100 kcal/mol/A^2</td>
</tr>
<tr>
<td style="text-align:left">bond equilibrium length $$r_0$$</td>
<td style="text-align:left">0.1 A</td>
</tr>
<tr>
<td style="text-align:left">angle force constant $$K_\theta$$</td>
<td style="text-align:left">100 kcal/mol/radian^2</td>
</tr>
<tr>
<td style="text-align:left">angle equilibrium angle $$\theta_0$$</td>
<td style="text-align:left">20 degrees</td>
</tr>
<tr>
<td style="text-align:left">proper torsion barrier height $$K$$  </td>
<td style="text-align:left">1 kcal/mol</td>
</tr>
<tr>
<td style="text-align:left">vdW well depth $$\epsilon$$</td>
<td style="text-align:left">0.1 kcal/mol</td>
</tr>
<tr>
<td style="text-align:left">vdW minimimum $$r_\mathrm{min-half}$$</td>
<td style="text-align:left">1 A</td>
</tr>
</tbody>
</table>
<p><a id="fitting-and-convergence"></a></p>
<h3 id="fitting-and-convergence">Fitting and convergence</h3>
<p>To compute loss function gradients with respect to parameters, we used dimensionless step sizes of 0.01 for improved numerical stability (which differs from the ForceBalance default of 0.001).</p>
<p>Fitting was terminated once two convergence criteria were met:</p>
<ol>
<li>The dimensionless parameter step size shrunk below 0.01;</li>
<li>The objective function decreased by less than 0.1 during the step</li>
</ol>
<br>
<a id="fitting-parsley-to-quantum-chemical-data"></a>
## Fitting Parsley to quantum chemical data
<p>Parsley focuses on improving valence parameters by optimizing valence terms from <a href="https://github.com/openforcefield/smirnoff99Frosst/releases/tag/1.1.0">SMIRNOFF99Frosst 1.1.0</a> to minimize discrepancies from high-level quantum chemical calculations.
Subsequent releases will incorporate refitting of nonbonded parameters based in part on condensed phase property data, but in our Parsley release, we utilize condensed phase property data only to ensure valence refitting has not adversely affected these properties.
Here, we provide an overview of the quantum chemical data utilized in fitting, then discuss which parameters were fit.</p>
<p><a id="quantum-chemical-dataset-generation"></a></p>
<h3 id="quantum-chemical-dataset-generation">Quantum chemical dataset generation</h3>
<p>Quantum chemical calculations (geometry optimizations and torsion scans) were performed on a distributed set of high-performance computing clusters using the <a href="https://qcfractal.readthedocs.io">MolSSI QCFractal</a> distributed quantum chemistry engine, with results deposited in the public <a href="https://qcarchive.molssi.org/">MolSSI QCArchive</a> to allow open public access to all data. Following a benchmark of conformational energetics discussed below, we decided on a single level of theory for all QM calculations: B3LYP-D3(BJ) / DZVP [<a href="https://doi.org/10.1139/v92-079">Godbout et al. 1992</a>, <a href="https://doi.org/10.1063/1.464913">Becke 1993</a>, <a href="https://doi.org/10.1063/1.3382344">Grimme et al. 2010</a>, <a href="https://doi.org/10.1002/jcc.21759">Grimme et al. 2011</a>]</p>
<p>Our choice of quantum chemical level of theory and basis set was based on two benchmark studies of conformational energies taken from the literature [<a href="https://doi.org/10.1021/acs.jctc.7b01074">Řezáč et al. 2018</a>, <a href="https://doi.org/10.1021/acs.jctc.5b01066">Kesharwani et al. 2016</a>] and our own initial studies that aimed to balance accuracy against computational cost.
The molecules in both of these studies included amino acids, small to medium-sized peptides, and macrocycles. Geometries were optimized at the MP2/cc-pVTZ level, and reference energies were computed using explicitly correlated focal point analysis methods considered to be equivalent to complete basis CCSD(T) in accuracy.
Both studies found that B3LYP-D3(BJ) reproduces the reference energies with RMSEs of &lt;1 kcal/mol when very large basis sets (e.g. <a href="https://doi.org/10.1039/B508541A">def2-QZVP</a>) were used; empirical dispersion played a major role, as the errors were typically 2-4x larger with uncorrected B3LYP.</p>
<p>Notably, <a href="https://doi.org/10.1021/acs.jctc.7b01074">Řezáč et al. 2018</a> reported that the double-zeta quality <a href="https://doi.org/10.1139/v92-079">DZVP basis set</a> gave nearly the same RMSE as def2-QZVP, which we were able to reproduce in our own tests. When similar-sized and better-known basis sets such as 6-31G* and def2-SV(P) were used, the RMSEs increased significantly but there were only minor differences in computational cost.
Our results are largely consistent with <a href="https://doi.org/10.1021/acs.jctc.7b01074">Řezáč et al. 2018</a> even though we did not use the custom empirical dispersion parameters they derived for the DZVP-DFT basis set. A scatter plot of RMSE vs. calculation time for a representative molecule, labeled as FGG114 in <a href="https://doi.org/10.1021/acs.jctc.7b01074">Řezáč et al. 2018</a>, is show in the figure below; the results confirm that the DZVP-DFT basis set gives the best compromise between accuracy and computational cost.</p>
<p>Although we think our choice of QM method is appropriate for gas-phase conformational energies, we did not conduct benchmark studies on optimized geometries and vibrational frequencies which were also part of our parameterization dataset.
More comprehensive benchmarks are planned to inform future force field generations.</p>
<center>
<img src="qm-speed-accuracy-tradeoff.png" width="50%">
</center>
**Tradeoff between speed and accuracy in selecting quantum chemical basis set.**
Computational time (for single conformer) versus RMSE to benchmark-quality relative energies for 15 conformations of a representative molecule from [Řezáč et al. 2018](https://doi.org/10.1021/acs.jctc.7b01074) (SMILES `N[C@@H](CC1=CC=CC=C1)C(NCC(NCC(O)=O)=O)=O)`) for several choices of basis set.
The  B3LYP-D3(BJ) method is used throughout.
The results show that the [DZVP basis](https://doi.org/10.1139/v92-079) provides the best compromise between accuracy and computational cost.
<p>Two sets of small organic molecules were used to generate the quantum chemical datasets used in fitting this first-generation force field:</p>
<center>
![alt text](roche-set-examples.png "An illustrative subset of small fragment-like molecules from the Roche Set")
</center>
<p><strong>Roche Set (468 small molecules)</strong>
The <strong>Roche Set</strong> contains 468 small fragment-sized molecules (most with at most a single rotatable bond) provided by Roche, and focuses on small molecule fragments viewed as important and/or containing interesting chemistries.
A visualization of the full set is available <a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-05-01-OpenFF-Group1-Torsions/optimization_inputs.pdf">here</a>.</p>
<center>
![alt text](coverage-set-examples.png "An illustrative subset of example molecules from the Coverage Set")
</center>
<p><strong>Coverage Set (80 molecules)</strong>
The <strong>Coverage Set</strong> contains 80 molecules, and was selected from a subset of <a href="https://www.emolecules.com/info/plus/download-database">eMolecules</a> using a greedy algorithm aimed at providing parameter coverage for the maximum number of parameters using the minimum number of molecules.
A visualization of the full set is available <a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-06-25-smirnoff99Frost-coverage/optimization_inputs.pdf">here</a>.</p>
<p>Construction of the original coverage set is described <a href="https://github.com/openforcefield/open-forcefield-data/tree/master/Utilize-All-Parameters">here</a> and then additional supplemental molecules were added manually <a href="https://github.com/openforcefield/open-forcefield-data/tree/master/Utilize-All-Parameters/supplement_molecules">as described here</a> to cover remaining gaps.
This process also resulted in the identification of issues with the hierarchy of SMIRKS patterns in <a href="https://github.com/openforcefield/smirnoff99Frosst">smirnoff99Frosst</a> (first in version 1.0.9, but then some issues were fixed and incorporated in the 1.1.0 release, so we built on that here), because we found it was impossible to utilize some parameters even on very large molecule sets. To remedy this, we moved parameter <code>a21</code> (<code>[*:1]~[#7X2:2]~[*:3]</code>) above the more specific <code>a17</code> (<code>[*:1]-[#7X4,#7X3,#7X2-1:2]-[*:3]</code>) before refitting, and adding <code>a34a</code> (<code>[*:1]=[#16X2:2]=[#8:3]</code>) and <code>t155b</code> (<code>[*:1]~[#7:2]=[#15:3]~[*:4]</code>) to cover certain chemistry which we did not originally cover.
The smirnoff99Frosst force field utilized as input for fitting, which is a modification of smirnoff99Frosst-1.1.0.offxml, is available in the release package (<a href="https://github.com/lpwgroup/forcebalance-qcarchive/releases/tag/v0.0.9">https://github.com/lpwgroup/forcebalance-qcarchive/releases/tag/v0.0.9</a>) as <code>fb-fit/forcefield/param_valence.offxml</code>.</p>
<p>After running quantum chemical calculations (described below) on the coverage set and performing subsequent filtering steps (described in the following section), coverage dropped slightly because results of some calculations had to be removed.
This meant that we no longer had data covering all of our parameters.
Particularly, we were missing data for 19 parameters occurring in 12 different chemical environments.
Some of this missing data was due to gaps in torsional coverage, e.g., a bond parameter in a molecule could not be fit if our force field did not include an appropriate torsion for that molecule.
Most un-covered parameters involved relatively unusual chemistry such as (parameter IDs in parentheses) unusual sulfur and phosphorus bonds (sulfur-iodine (<code>b47</code>), sulfur-fluorine (<code>b44</code>), phosphorus-fluorine (<code>b79</code>), phosphorus-iodine (<code>b82</code>), doubly-connected phosphorus with two double bonds (<code>a33</code>)). We also had no carbon-iodine bonds with tetravalent carbon in our set (<code>b74</code>), no nitrogen-iodine bonds (<code>b78</code>), and, oddly, no carbon-sulfur single bonds (<code>b41</code>), for reasons which will require examining.
We were missing coverage of four torsions, including the relatively generic <code>t58</code> (probably because more specialized SMIRKS patterns cover all of the common occurrences of this), and the more specialized <code>t60</code>, <code>t131</code>, and <code>t103</code>.
If these parameters are to be retained, we will likely need to prioritize covering them for subsequent releases.</p>
<p>For the Coverage Set, both <a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-06-25-smirnoff99Frost-coverage">optimization</a> and <a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-07-01-smirnoff99Frost-coverage-torsion">torsion drive datasets</a> were constructed from this set.</p>
<p>These sets were utilized in this round of fits not because we considered them most representative of the chemistry of interest, but because they exercised the vast majority of our parameters and the data was ready when it was time for fitting for this release.
Future force field releases will invest more effort in ensuring training data is broadly representative of the chemical space of interest and has a significant number of occurrences of all parameters.</p>
<p>For each set of molecules, three classes of quantum chemical data were generated:</p>
<ol>
<li>Optimized geometry/geometries;</li>
<li>Vibrational frequencies;</li>
<li>Torsion profiles.</li>
</ol>
<p>The results of our quantum chemical calculations are stored as <code>DataSet</code>s on <a href="http://qcarchive.molssi.org">QCArchive</a> and are freely available to the public.
The <a href="https://qcarchivetutorials.readthedocs.io/en/latest/basic_examples/optimization_datasets.html">QCArchive documentation</a> can provide a helpful starting point, or <a href="https://github.com/openforcefield/release-1-benchmarking/blob/master/QM_molecule_selection/divide_sets.ipynb">this notebook</a> gives an example of working with several QCArchive datasets.</p>
<p><a id="optimization-datasets"></a></p>
<h4 id="optimized-quantum-chemical-geometries-optimizationdataset">Optimized quantum chemical geometries (<code>OptimizationDataset</code>)</h4>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Input molecules</strong></th>
<th style="text-align:left"><strong>Roche Set</strong> (468 molecules)</th>
<th style="text-align:left"><strong>Coverage Set</strong> (80 molecules)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Dataset construction</strong></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-05-16-Roche-Optimization_Set">GitHub repo</a></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-06-25-smirnoff99Frost-coverage">GitHub repo</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>QCArchive <code>OptimizationDataset</code> name</strong>  </td>
<td style="text-align:left"><code>OpenFF Optimization Set 1</code>  </td>
<td style="text-align:left"><code>SMIRNOFF Coverage Set 1</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>Number of optimized geometries</strong></td>
<td style="text-align:left">936</td>
<td style="text-align:left">831</td>
</tr>
</tbody>
</table>
<p>Prior to running quantum chemical calculations, the input molecules first undergo a protonation state and conformer expansion using our <a href="https://github.com/openforcefield/fragmenter"><code>fragmenter</code> package</a> version <a href="https://github.com/openforcefield/fragmenter/tree/87b85a406aa9c6ac0cfbaf582ed05c55799161a9">0.0.2+121.g87b85a4</a>.
After the expansion, each state is identified as a new molecule, so the number of distinct molecules may increase, and each molecule may have one or more conformers.
Each conformer provides one optimized geometry used in fitting.</p>
<p>The QCArchive server carries out geometry optimizations using the <a href="https://github.com/leeping/geomeTRIC">geomeTRIC optimization driver</a> [<a href="https://doi.org/10.1063/1.4952956">Wang and Song 2016</a>] and the <a href="http://www.psicode.org/">psi4 quantum chemistry package</a> [<a href="https://doi.org/10.1021/acs.jctc.7b00174">Parrish et al. 2017</a>] as backends.
Optimized QM geometries were downloaded from the QCArchive server, then filtered to remove cases where the bonding pattern changes on optimization, as well as issues which pose other problems for the <a href="https://github.com/openforcefield/openforcefield/releases/tag/0.4.1">openforcefield toolkit v0.4.1</a>, e.g. undefined stereochemistry, missing torsion terms, or inability to assign AM1-BCC charges.<br>
Details can be found in <a href="https://github.com/openforcefield/openforcefield-forcebalance/blob/master/vib_freq_target/make_vib_freq_target.py">this script</a>, and molecules which were removed can be found in <code>fb-fit/targets/error_mol2s</code> in the release package.</p>
<p>To further improve fits to optimized geometries, a new fitting method we call “internal coordinate fitting” was implemented in ForceBalance.
The method performs MM geometry optimizations starting from QM optimized structure.
It then converts the Cartesian coordinates to a redundant list of bond lengths, bond angles, and torsion angles (i.e. “primitive internal coordinates”) with geomeTRIC, and computes the difference between MM and QM values.
Three types of internal coordinates contribute square summed differences to the objective function with following parameter penalty $$\sigma_p$$ scales:</p>
<ul>
<li>Bond lengths: 0.05 Angstroms</li>
<li>Angles: 8 degrees</li>
<li>Improper torsions: 20 degrees</li>
</ul>
<p>The proper torsion angles are not fitted as part of the optimized geometry fitting target, because the torsion profiles provide the vast majority of data to inform the torsion parameters. In fact, far more geometry optimizations were done in constructing torsion profiles than for any other reason.</p>
<p><a id="vibrational-datasets"></a></p>
<h4 id="vibrational-frequency-datasets">Vibrational frequency datasets</h4>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Input molecules</strong></th>
<th style="text-align:left"><strong>Roche Set</strong> (468 molecules)</th>
<th style="text-align:left"><strong>Coverage Set</strong> (80 molecules)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Dataset construction</strong></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-07-09-OpenFF-Optimization-Set">GitHub repo</a></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-06-25-smirnoff99Frost-coverage">GitHub repo</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>QCArchive <code>OptimizationDataset</code> name</strong>  </td>
<td style="text-align:left"><code>OpenFF Optimization Set 1</code>  </td>
<td style="text-align:left"><code>SMIRNOFF Coverage Set 1</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>Number of vibrational datasets</strong></td>
<td style="text-align:left">660</td>
<td style="text-align:left">235</td>
</tr>
</tbody>
</table>
<p>Hessian calculations were submitted to QCArchive for each optimized geometry in both molecule sets.</p>
<p>The vibrational frequency fitting targets are prepared by: 1) downloading Hessian data for each optimized geometry from QCArchive server; 2) Picking the lowest-energy conformer of each molecule; 3) Applying the same filters as for the optimized geometry targets (bond changes and toolkit errors); and 4) Conducting normal-mode analysis to get harmonic vibrational frequencies for non-translational and non-rotational degrees of freedom. Details can be found in <a href="https://github.com/openforcefield/openforcefield-forcebalance/blob/master/vib_freq_target/make_vib_freq_target.py">this script</a>.</p>
<p>During the fitting, the MM Hessian is computed by evaluating forces with numerical displacements (0.001 Angstrom). The MM Hessian undergoes the same normal mode analysis as QM, then vibrational frequencies are aligned from lowest to highest. Pairwise squared differences then contribute to the total objective function with a denominator of 200 cm$$^{-1}$$.</p>
<p><a id="torsiondrive-datasets"></a></p>
<h4 id="torsion-drive-datasets-torsiondrivedataset">Torsion drive datasets (<code>TorsionDriveDataset</code>)</h4>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Input molecules</strong></th>
<th style="text-align:left"><strong>Roche Set</strong> (468 molecules)  </th>
<th style="text-align:left"><strong>Coverage Set</strong> (80 molecules)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Dataset construction</strong></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-05-01-OpenFF-Group1-Torsions">GitHub repo</a></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-07-01-smirnoff99Frost-coverage-torsion">GitHub repo</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>QCArchive <code>OptimizationDataset</code> name</strong>  </td>
<td style="text-align:left"><code>OpenFF Group1 Torsions</code>  </td>
<td style="text-align:left"><code>SMIRNOFF Coverage Torsion Set 1</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>Number of 1D torsion drives</strong></td>
<td style="text-align:left">669</td>
<td style="text-align:left">417</td>
</tr>
</tbody>
</table>
<p>The QM torsion profiles were generated by <a href="https://github.com/lpwgroup/torsiondrive">TorsionDrive</a>, which carries out 360 degree dihedral scans with constrained geometry optimizations (with geomeTRIC [https://doi.org/10.1063/1.4952956]), spaced 15 degrees apart.
The torsion angle was not scanned past structures with energies more than 0.05 Hartrees above the minimum, thus improving the stability of the scans by avoiding bond-breaking and unusual structures caused by constrained optimization.</p>
<center>
![alt text](example-torsions.png "Example torsions selected for 1D torsion scans in the Roche TorsionDrive dataset.")
</center>
<p>The scanned dihedral angles were selected using different strategies for the two sets of molecules:</p>
<p>For the <strong>Roche Set</strong>, we selected 819 dihedral angles that match all following conditions: a) the center bond is not part of a ring; b) no hydrogen atom is involved; c) neither of the two angles involved is close to linear (&gt;= 165 degree); d) the center bond has not been previously scanned. Among all torsions sharing the same center bond, the torsion with the heaviest side group (by number of atoms) is picked.</p>
<p>For the <strong>Coverage Set</strong>, we used the SMIRNOFF force field to label the torsions in each molecule, then the first five dihedral angles that match each torsion term were selected for scanning.
(Note: the force field term <code>t155b</code> was added after this dataset was created, so no torsion is selected for that term.)
Multiple initial geometries were generated for each molecule via <code>fragmenter</code>, and we provided all generated conformers for each molecule as “initial geometries” at the beginning of the torsion scan, to improve the coverage of conformational space.</p>
<p>The torsion profile fitting targets are prepared by a) downloading the relevant torsion scan trajectories from the QCArchive server; b) checking molecule topology with toolkit; c) filtering out trajectories that contain any frame with hydrogen bonds, to avoid building strong internal electrostatic interactions into fitted torsional profiles.
Hydrogen bonds are detected using <a href="http://mdtraj.org/latest/api/generated/mdtraj.baker_hubbard.html#mdtraj.baker_hubbard">Baker Hubbard method</a> [ Angle(D-H..A) &gt; 120 degrees and Dist(H..A) &lt; 2.5 A ] implemented in <a href="http://mdtraj.org"><code>mdtraj</code></a> package.
Details can be found in <a href="https://github.com/openforcefield/openforcefield-forcebalance/blob/master/torsion_target/make_torsion_target_new.py">this script</a>.</p>
<p>The geometries used in fitting are constrained local minima in the QM method, but they are not local minima in the MM method.
This creates a problem because MM simulations will involve some amount of relaxation on the MM surface (e.g. due to differences in the description of bonded interactions or sterics) that varies depending on the torsion angle.
This could worsen the level of agreement between MM and QM probability distributions, which is what we are truly interested in (but cannot compute due to cost reasons).
To compensate for this problem, the fitting of the torsion profiles involves an MM restrained optimization, followed by computing the squared difference in relative energies between the QM and MM torsion profiles.
During the restrained geometry optimization, the four atoms of the torsion being scanned is kept at the QM coordinates, and the coordinates of every other atom are optimized with a harmonic restraining force of 1 kcal/mol/A$$^2$$ centered at the original location.</p>
<br>
<a id="fitting-results"></a>
## Optimizing parameters for Parsley
<p><a id="parameters-fitted"></a></p>
<h3 id="parameters-fit-in-parsley">Parameters fit in Parsley</h3>
<p>In SMIRNOFF99Frosst and Parsley, valence parameters consist of the following terms (when specific identifiers are given, these refer to the “parameter ID” in the Parsley release and the SMIRNOFF99Frosst force field from which fitting began, available in our <a href="https://github.com/openforcefield/openforcefield-forcebalance/releases/tag/v1.0.0-RC2">release package</a> (in the <code>fb-fit/forcefield/param_valence.offxml</code> file):</p>
<ul>
<li><strong>Harmonic bond stretch</strong>: 86 equilibrium bond lengths and 86 force constants.</li>
<li><strong>Harmonic angle bend</strong>: 35 equilibrium angles and 39 force constants (several angles are linear and kept linear during fitting &ndash; specifically, angles a3 (SMIRKS <code>[*;r3:1]1~;@[*;r3:2]~;@[*;r3:3]1</code>), a16 (<code>[*:1]~[#6X2:2]~[*:3]</code>), a21 (<code>[*:1]~[#7X2:2]~[*:3]</code>), a34 (<code>[*:1]=[#16X2:2]=[*:3]</code>), and a38 (<code>[*:1]~[#15:2]~[*:3]</code>). Parameter IDs can be viewed in the <a href="https://github.com/openforcefield/openforcefields/blob/master/openforcefields/offxml/openff-1.0.0-RC2.offxml">OFFXML</a>.)</li>
<li><strong>Proper torsions</strong>: Each torsion uses one or more barrier heights <code>k</code> followed by integers, e.g. <code>k1</code> or <code>kN</code>, where <code>N</code> is an integer that the periodicity of the term that force constant is applied to. Here, terms were: 154 <code>k1</code> values, 62 <code>k2</code> values, 26 <code>k3</code> values, 5 <code>k4</code> values, 4 <code>k5</code> values, and 3 <code>k6</code> values, for a total of 254 parameters. Parameters <code>t156</code>, <code>t157</code>, <code>t158</code> are place holders matching linear bond, thus their <code>k1</code> is kept at 0.0 during fitting. Periodicity and phase parameters were not optimized in this release to ensure that we did not overfit in initial efforts where the number of molecules utilizing some parameters remains small.</li>
<li><strong>Improper torsions</strong>: Not fitted. All 4 terms are kept the same.</li>
</ul>
<p>In this release, we were thus prepared to fit up to a total of 500 bonded parameters (applied by 279 SMIRKS patterns: 86 bonds, 39 angles, and 154 torsions).
The QCArchive datasets we utilized for fitting (see below) exercised 481 of these parameters, so 19 parameters were left unchanged in our fitting efforts. However, a number of other parameters covered unusual chemistry, even within eMolecules (where our “coverage set”, below, was drawn from), and thus we had no molecules utilizing these parameters in our available QM data.</p>
<p>All of the above parameters are fitted simultaneously against all QM data.</p>
<p><a id="fitting-valence-terms"></a></p>
<h3 id="fitting-valence-terms">Fitting valence terms</h3>
<p>The objective (or loss) function&mdash;the weighted sum of squared differences between QM and MM values&mdash;decreased dramatically in the fitting, from 25708 to 4522.</p>
<center>
<img src="fitting-valence-terms.png" width="50%">
</center>
**Total loss function at each iteration of parameter fitting.**
The y-axis shows the (dimensionless) loss function.
<p>Improvements in optimized bond lengths and angles, as well as torsion profiles are observed for a great amount of reference data.</p>
<p>Full details of fitting can be found at <a href="https://github.com/openforcefield/openforcefield-forcebalance/releases/tag/v1.0.0-RC2">https://github.com/openforcefield/openforcefield-forcebalance/releases/tag/v1.0.0-RC2</a></p>
<p><a id="improvements-in-geometries"></a></p>
<h3 id="improvements-in-optimized-geometries">Improvements in optimized geometries</h3>
<center>
<img src="objective-function-contributions.png" width="80%">
</center>
**Improved objective function of all optimized geometry target contributions.**
Targets are sorted from left to right based on their final contributions to the objective function (shown in red), so the x-axis denotes the sorted target number. Gray shows the initial contribution of each target to the objective function (that is, the values with the initial forcefield). Everywhere the red line is below the gray, fitting improves performance on that target, and everywhere gray is below red, fitting hurt performance on that target. On the whole, fitting improves performance on the vast majority of geometries, but some are degraded to some extent.
<p>This figure shows an overall improvement agreement between QM and MM optimized geometries.
Most targets have improved agreement, though there are a few targets with a reduced level of agreement. This is an expected behavior since compromises have to be made for some molecules to improve the fitting quality of other molecules that share the use of the same parameter.
On the whole, it seems encouraging that here, the vast majority of targets seem to have significantly improved agreement.</p>
<p>We also generated scatter plots that group internal coordinates corresponding to the same bond or angle term from all molecules. Full set of plots can be downloaded from <a href="https://github.com/lpwgroup/forcebalance-qcarchive/releases/tag/v0.0.9">https://github.com/lpwgroup/forcebalance-qcarchive/releases/tag/v0.0.9</a></p>
<p>Samples are shown here:</p>
<center>
<img src="b15.png" width="40%"><img src="b51.png" width="40%">
</center>
**QM vs MM optimized bond lengths compared before and after fitting.**
The fitting updates the equilibrium bond lengths (orange and green vertical lines), and results in an improved MM bond length distribution. Ideally, values would be clustered around the X=Y line, or at least centered on it. Here, in both cases, final values (blue) are much closer to the X=Y line, indicating improved bond lengths after fitting. The green line denotes the equilibrium bond length specified for this bond parameter after optimization, but actual optimized bond lengths do not necessarily match this value due to other energetic terms (e.g. steric interactions involving the surrounding environment).
<p>As shown in the above figure, we found that for most force field terms, the QM vs MM distribution is improved, appearing on the scatter plot as shifted horizontally closer to the diagonal line.</p>
<center>
<img src="b36.png" width="40%">
</center>
Some QM vs MM bond lengths scatter plots show a greater distribution of QM optimized bond lengths, indicating a split of the bond term may improve the quality of the fit. More data is also likely warranted in this case.
<p>We also found a few terms with a greater distribution of QM optimized bond lengths, such as the above term <code>b36</code> (<code>[#7:1]=[#7:2]</code>) for N=N double bonds. This distribution indicates a split in the force field term may result in better QM vs MM agreement. This is also expected behavior, indicating cases where the typing or chemical perception utilized in the force field (here, held fixed during fitting) may need further improvement.</p>
<p>Chemical perception issues will be a major focus of development following our initial Parsley release, as there is clear room for improvement in many cases.
One such example is shown here:</p>
<center>
<img src="carbon-nitrogen-bond-heterogeneity.png" width="100%">
</center>
**Bond lengths described by the generic carbon-nitrogen single bond show considerable heterogeneity.**
Shown is bond length data from torsion drives on the Roche dataset, showing the bond length as a function of torsional angle for the molecules utilizing the generic carbon-nitrogen single bond (after other chemical environments are treated separately). At right is a histogram of the observed bond lengths, showing at least two to three distinct groups of bond lengths. This seems to indicate the generic should be subdivided into two or three more specialized parameters in subsequent work on chemical perception.
<p><a id="improvements-in-vibrational-frequencies"></a></p>
<h3 id="improvements-in-vibrational-frequencies">Improvements in vibrational frequencies</h3>
<center>
<img src="vibrational-frequency-contributions.png" width="80%">
</center>
**Improved objective function of all vibrational frequency target contributions.**
As in the figure above, the red curve shows the sorted contribution of each target to the final objective function after fitting, and the gray shows performance before fitting.
<center>
<img src="vibrational-frequencies-rmsd.png" width="80%">
</center>
**RMSD of vibrational frequencies before and after fitting.**
<p>A peek at the RMSD of the QM vs MM vibrational frequencies shows the fitting is effective in improving such agreement.</p>
<center>
<img src="vibrational-frequencies-initial.png" width="40%"><img src="vibrational-frequencies-final.png" width="40%">
</center>
**Improvements in vibrational frequencies for an example molecule.**
Improvements are mainly observed in medium and high frequency modes.
<p><a id="improvements-in-torsion-profiles"></a></p>
<h3 id="improvements-in-torsion-profiles">Improvements in torsion profiles</h3>
<p>We also observe an overall decrease of objective function contribution from torsion profiles.</p>
<center>
<img src="torsion-contributions.png" width="80%">
</center>
**Objective function contributions of all torsion profile targets.**
As above, the red shows contribution of each target to the final objective function after fitting, and the gray shows the same contribution but for the initial force field. Again, substantial improvement is observed in general, with a degradation of performance in a modest subset of cases.
<center>
<img src="torsion-profile-example.png" width="60%">
</center>
**An example of improved MM vs QM agreement for a torsion profile.**
The metadata at the bottom explains which dataset this data is drawn from, and which specific molecule this torsion occurs in, as well as the SMIRKS pattern for the particular torsion being fitted here. The total count of this SMIRKS pattern across the dataset is also shown at the bottom, as well as the parameter ID and the atom indices in the molecule.
<p>We also found that a few torsion profiles were fitted with worse quality. They may be caused by nonoptimal torsion term definitions or periodicity/phase. These are worth investigating for further improvements of the force field.
The full set of plots are available in the <a href="https://github.com/lpwgroup/forcebalance-qcarchive/releases/tag/v0.0.9">release package</a>.</p>
<center>
<img src="degraded-torsion-profile.png" width="60%">
</center>
**An example of degraded, or at least not improved, MM vs QM agreement for a torsion profile.**
The metadata is as in the figure just prior.
<br>
<a id="benchmarking-parsley"></a>
## Benchmarking Parsley
<p><a id="quantum-chemical-benchmarks"></a></p>
<h3 id="quantum-chemical-benchmarks">Quantum chemical benchmarks</h3>
<p>We wanted to assess coverage/performance on molecules resembling the training data used for this release (the Roche and Coverage Sets, which covered somewhat limited chemistry), while also assessing performance on a broader set of druglike chemistries. Therefore, we constructed two sets for benchmarking.</p>
<p>For our benchmarking sets, we drew from three QCArchive datasets.
The first of these is the <code>OpenFF Discrepancy Benchmark 1</code> dataset.
This contains some 2802 unique molecules (19 712 conformers) resulting from the work of <a href="http://dx.doi.org/10.5281/zenodo.3385278">Ehrman et al.</a> in the <a href="https://mobleylab.org/">Mobley lab</a>, which energy minimized all of eMolecules in several different force fields and then extracted molecules with geometries which were significantly different across force fields. This particular subset, as described in our <a href="https://github.com/openforcefield/qca-dataset-submission/tree/5105bb950183392dea208684b0889f29e311d2ee/2019-07-05%20eMolecules%20force%20field%20discrepancies%201">dataset repository</a>, focuses on fragment-like molecules with geometries which are substantially different in <code>smirnoff99Frosst</code> 1.0.8 relative to GAFF, GAFF2, and MMFF94 and 94s. As the full set of eMolecules was still in process, this represents the first 2802 molecules with significant discrepancies identified in this study, with the full set becoming available later.</p>
<p>While this set was rather diverse and, based on inspection, chemically interesting, it also seemed to overrepresent certain chemistry (e.g. Br occurs more than one might expect), so we were concerned that this might not be representative of our target chemistry. Thus, to ensure sets were representative of the chemistry of interest, we generated two additional sets for benchmarking:</p>
<ul>
<li>Xinjun Hou and Brajesh Rai at Pfizer provided 100 challenging small molecule fragments where Pfizer’s QM calculations of torsional profiles differed substantially from OPLS3e, as further discussed <a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-09-07-Pfizer-discrepancy-optimization-dataset-1">in our dataset repository</a>. After enumeration of conformers, we ran geometry optimizations and torsional scans, utilizing the geometry optimizations in this work as our <code>Pfizer Discrepancy Optimization Dataset 1</code>.</li>
<li>The <a href="http://zinc.docking.org/substances/subsets/fda/">ZINC15 FDA dataset</a> formed the basis of our final set, and we filtered to remove molecules with fewer than 3 or more than 55 heavy atoms, as well as removing metals and only allowing molecules containing the elements H, C, N, O, F, P, S, Cl, Br, I and B. After conformer generation this resulted in 1038 molecules and 6675 conformers, as further discussed on our <a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-09-08-fda-optimization-dataset-1">dataset repository</a>. This resulted in our <code>FDA Optimization Dataset 1</code>.</li>
</ul>
<p>Additional datasets will likely be warranted in the future, but the set of FDA approved drugs certainly provides a reasonable starting point for chemistry of interest.</p>
<p>Torsion drives on the above sets were also conducted, but this data was not yet available at the time of benchmarking.</p>
<p>To assess performance on chemistry which we expected to be well-covered by our training data, we partitioned the available benchmark data into two sets:</p>
<ul>
<li><strong>Primary benchmark set</strong>: a small set containing similar chemistry to our training sets and only utilizing parameters which occurred in three molecules or more in training data</li>
<li><strong>Full benchmark set</strong>: and a large set containing the small set and all of the additional compounds available in the above datasets</li>
</ul>
<p>As we discuss further below, the difference in performance between these two sets did not end up being dramatic.</p>
<p>Division into these two sets was done based on path-based fingerprint similarity comparisons between all molecules (building out a full similarity/distance matrix) utilizing the OpenEye toolkits, followed by clustering with DBSCAN, with a minimum Tanimoto similarity of 0.5 for molecules in the same cluster. Only molecules which were in clusters with at least one training set molecule were considered for inclusion in the primary benchmark set, provided they also utilized no parameters occurring in fewer than three molecules in the training set. Code for this process is available <a href="https://github.com/openforcefield/release-1-benchmarking/blob/master/QM_molecule_selection/divide_sets.ipynb">in a notebook in our release benchmarking repository</a></p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Input molecules</strong></th>
<th style="text-align:left"><strong>Discrepancy Set</strong> (2802 molecules)</th>
<th style="text-align:left"><strong>Pfizer Set</strong> (100 molecules)</th>
<th style="text-align:left"><strong>FDA drugs set</strong> (1038 molecules)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Dataset construction</strong></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-07-05%20eMolecules%20force%20field%20discrepancies%201">GitHub repo</a></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-09-07-Pfizer-discrepancy-optimization-dataset-1">GitHub repo</a></td>
<td style="text-align:left"><a href="https://github.com/openforcefield/qca-dataset-submission/tree/aae895e03a402910ac389e6b5dcb5686c1e9fceb/2019-09-08-fda-optimization-dataset-1">GitHub repo</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>QCArchive <code>OptimizationDataset</code> name</strong></td>
<td style="text-align:left"><code>OpenFF Discrepancy Benchmark 1</code></td>
<td style="text-align:left"><code>Pfizer Discrepancy Optimization Dataset 1</code></td>
<td style="text-align:left"><code>FDA Optimization Dataset 1</code></td>
</tr>
<tr>
<td style="text-align:left"><strong>Number of optimized geometries</strong></td>
<td style="text-align:left">19479</td>
<td style="text-align:left">352</td>
<td style="text-align:left">5410</td>
</tr>
</tbody>
</table>
<p>The final result of this work was that we combined the above three datasets into two new datasets on QCArchive, the <code>OpenFF Primary Optimization Benchmark 1</code>, and the <code>OpenFF Full Optimization Benchmark 1</code>.
These can be retrieved from QCArchive under these names as shown in the <a href="https://qcarchivetutorials.readthedocs.io/en/latest/basic_examples/optimization_datasets.html#">QCArchive documentation</a>.</p>
<p>Additional datasets for the corresponding torsion drive data, the “OpenFF [Primary/Full] TorsionDrive Benchmark 1” sets, were also constructed but not utilized in this phase of benchmarking because the calculations were not yet complete.</p>
<p>We utilized ForceBalance for QM benchmarks. Currently two types of benchmarks are carried out:</p>
<ol>
<li>The QM vs MM optimized geometries. This utilized the same functionality as in the fitting</li>
<li>The relative energies between conformers at QM optimized geometries. We aggregated all optimized geometries of each conformer into unique molecules, and filtered out the molecules with less than 3 conformers. MM energies are evaluated at the QM geometries for each conformer and the relative energies with respect to the lowest-energy conformer are compared between MM and QM.</li>
</ol>
<p><a id="primary-set-benchmarks"></a></p>
<h4 id="benchmarks-for-the-primary-set">Benchmarks for the Primary Set</h4>
<p>Our small primary benchmark set of molecules utilized 224 out of the total 500 parameters. We found an overall improvement when evaluating the QM vs MM agreements in optimized geometries and relative energy of conformers.</p>
<p>The total objective function value for the optimized force field is 1121, compared to the initial force field of 1435.</p>
<center>
<img src="primary-set-bonds-rmse.png" width="80%">
</center>
**Bond length RMSE comparison for initial and optimized force fields for the Primary Set.**
Blue bars show the RMSE for the initial force field; green show decreased RMSEs for the optimized force field, and red show increased RMSEs for the optimized force field. In general, we see significantly more green than red, indicating more bond lengths are improved than are degraded in the final force field. SMIRKS patterns for these parameter IDs can be retrieved from the [offxml](https://github.com/openforcefield/openforcefields/blob/master/openforcefields/offxml/openff-1.0.0-RC2.offxml).
<p>The above plot shows an overall decrease of RMSE in bond lengths when using optimized force field compared to the initial version. Comparable plots for angles and torsions are available in our <a href="https://github.com/openforcefield/release-1-benchmarking/releases/tag/v0.0.3">benchmark package release</a> in the <code>.tar.gz</code> files at the bottom of the <a href="https://github.com/openforcefield/release-1-benchmarking/releases/tag/v0.0.3">release page</a>.</p>
<p>To investigate the impact of the improvement in the optimized force field on each individual molecule, the weighted root-mean-square deviation (RMSD) between internal coordinates of MM minimized geometry and QM minimized geometry of each molecule was calculated. Comparison of the weighted RMSD values shows 80.5% of geometries in the primary set (1490 out of 1850 geometries) are improved in the optimized force field compared to the initial force field.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th style="text-align:left"><strong>SMILES</strong></th>
<th><strong>Molecule ID</strong>  </th>
<th>RMSD</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td style="text-align:left"><code>c1ccc(cc1)CO</code></td>
<td>4029232</td>
<td>0.50</td>
</tr>
<tr>
<td>1</td>
<td style="text-align:left"><code>c1cc(c(cc1C(=O)CBr)Cl)F</code></td>
<td>2427669</td>
<td>1.44</td>
</tr>
<tr>
<td>2</td>
<td style="text-align:left"><code>COC(=O)c1cccnc1</code></td>
<td>3811900</td>
<td>1.50</td>
</tr>
<tr>
<td>3</td>
<td style="text-align:left"><code>c1cc(c(cc1C(=O)CBr)Cl)F</code></td>
<td>2427641</td>
<td>1.53</td>
</tr>
<tr>
<td>4</td>
<td style="text-align:left"><code>Cc1ccc(cc1F)C(=O)CBr</code></td>
<td>2539832</td>
<td>1.68</td>
</tr>
<tr>
<td>⋮</td>
<td style="text-align:left">⋮</td>
<td>⋮</td>
<td>⋮</td>
</tr>
<tr>
<td>1845</td>
<td style="text-align:left"><code>Cc1ccc2c(c1)CCCN2C(=O)Cc3cc4c(c(c3)Cl)OCCO4</code></td>
<td>3019671</td>
<td>573.36</td>
</tr>
<tr>
<td>1846</td>
<td style="text-align:left"><code>c1cc2c(cc1CC(=O)N3CCSc4c3cc(cc4)Cl)OCCO2</code></td>
<td>2700900</td>
<td>591.29</td>
</tr>
<tr>
<td>1847</td>
<td style="text-align:left"><code>c1cc2c(cc1CC(=O)N3CCSc4c3cc(cc4)Cl)OCCO2</code></td>
<td>2703270</td>
<td>591.32</td>
</tr>
<tr>
<td>1848</td>
<td style="text-align:left"><code>CN(c1ccccc1)C(=O)c2ccc(c(c2)F)F</code></td>
<td>2695418</td>
<td>758.19</td>
</tr>
<tr>
<td>1849</td>
<td style="text-align:left"><code>CN(c1ccccc1)C(=O)c2ccc(c(c2)F)F</code></td>
<td>3287309</td>
<td>764.12</td>
</tr>
<tr>
<td><strong>Molecules listed in increasing order of weighted RMSD.</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>First five molecules with the smallest objective values and five molecules with the largest objective values from the optimized force field.</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Molecule 893_C7H8O is the best described chemistry with the optimized force field and molecule <code>CN(c1ccccc1)C(=O)c2ccc(c(c2)F)F</code> (molecule ID: 3287309) is the worst described chemistry The main contribution of the high rmsd value (764.12) comes from dihedral angles.
Dihedrals whose central bonds contain nitrogen atom in this molecule apparently off by a lot from QM dihedral angles (&gt; 100 degrees) in the optimized geometry.
Including the molecule, most of the geometries with very high RMSDs are found to be conjugated systems which have an amide functional group.</p>
<center>
<img src="best-molecule.png" width="30%"> <img src="third-worst-molecule.png" width="30%"> <img src="worst-molecule.png" width="30%">
</center>
**Overlay of QM and MM minimized geometries for best- and worst-described molecules.**
MM geometries are shown in transparent green.
*Left:* The best-described molecule, `c1ccc(cc1)CO` (molecule ID: 4029232).
*Middle:* The third-worst-described molecule, `c1cc2c(cc1CC(=O)N3CCSc4c3cc(cc4)Cl)OCCO2` (molecule ID: 2703270).
*Right:* the worst-described molecule, `CN(c1ccccc1)C(=O)c2ccc(c(c2)F)F` (molecule ID: 3287309).
<p><a id="primary-set-benchmarks"></a></p>
<h3 id="benchmarks-for-the-full-set">Benchmarks for the Full Set</h3>
<p>Our Full Set of benchmark molecules (of which the primary set is a subset) utilizes 415 out of 500 parameters. Coverage is not as good as that of the training set in part because a portion of the training set (the “coverage set”) was deliberately constructed to utilize almost all parameters, whereas the benchmark set focuses on more drug-like chemistry and/or molecules which had geometric discrepancies, as discussed above.</p>
<p>The total objective function value for the optimized force field is 20672, compared to the initial force field of 29469.</p>
<center>
<img src="full-set-bonds-rmse.png" width="80%">
</center>
**Bond length RMSE comparison for initial and optimized force fields for Full Set.**
Blue bars show the RMSE for the initial force field; green show decreased RMSEs for the optimized force field, and red show increased RMSEs for the optimized force field. As on the primary set, performance on the full set seems to be significantly better in most cases. SMIRKS patterns for these parameter IDs can be retrieved from the [offxml](https://github.com/openforcefield/openforcefields/blob/master/openforcefields/offxml/openff-1.0.0-RC2.offxml).
<p>The above plot shows an overall decrease of RMSE in bond lengths when using optimized force field compared to the initial version. Comparable plots for angles and torsions are available in our <a href="https://github.com/openforcefield/release-1-benchmarking/releases/tag/v0.0.3">release package</a>.</p>
<p><a id="physical-property-benchmarks"></a></p>
<h3 id="physical-property-benchmarks">Physical property benchmarks</h3>
<p>The condensed phase physical property benchmark data set was curated from data made publicly available in the <a href="https://www.nist.gov/mml/acmd/trc/thermoml">NIST ThermoML Archive</a>, which contains a wealth of published thermophysical data.</p>
<p><a id="hysical-property-benchmark-construction"></a></p>
<h4 id="construction-of-the-physical-property-benchmark-set">Construction of the physical property benchmark set</h4>
<p>The intention was to assess the performance of the newly refit force field against a set of pure densities and enthalpies of vaporization (two historically common fitting targets for force field non-bonded interactions), pure static dielectric constants (which appear to have strong correlations with hydration free energies) and binary enthalpies of mixing and excess molar volumes (which we believe to have correlations with binding affinities).</p>
<p>We automated the curation of such a data set by performing the following series of steps:</p>
<ol>
<li>All available pure <strong>density</strong>, <strong>enthalpy of vaporization</strong>, <strong>static dielectric constant</strong>, <strong>binary excess molar volume</strong>, and <strong>enthalpy of mixing data</strong> was extracted from data tar balls made available to us from the <a href="https://www.nist.gov/mml/acmd/trc/thermoml">NIST ThermoML Archive</a>. In those cases where multiple values had been reported at the same experimental conditions, only the data points with the smallest experimental uncertainty were retained.</li>
<li>Any data which was measured for molecules appearing in the non-bonded condensed phase training set used to produce the parsley release candidate 1 (<a href="https://github.com/openforcefield/openforcefield-forcebalance/releases/tag/v1.0.0-RC1">Parsley RC 1</a>) force field was removed.</li>
<li>A global set of filters were applied to the data only data which was appropriate for our target conditions and chemistry. In particular, we only retained data which was measured
<ol>
<li>at biologically relevant and near ambient conditions&mdash;specifically at temperatures between 288 K and 318 K, and pressures between 0.95 atm and 1.05 atm.</li>
<li>for substances which did not contain any metals, and were composed of only the elements H, N, C, O, S, F, Cl, Br, I</li>
<li>for non-ionic liquids, which we do not expect to be described well by the current parameters
Further, we only retained static dielectric constant data with measured values &gt; 10, as low substances with a low dielectric constant can be challenging to estimate accurately with simulation.</li>
</ol>
</li>
<li>A greedy search was employed to choose the specific molecules which should appear in the set.
The goals of this search were broadly to i) prioritise molecules for which data was available for the most properties of interest, as most of these properties can be estimated from the same simulation data, ii) choose molecules which exhibit a diverse range of chemistry, with a focus on choosing molecules which exercise the largest number of chemical environments for which we parameters and iii) which were not overly computationally taxing to simulate.
In practice, this was implemented by ranking and sorting all molecules in the available set by
<ol>
<li>the number of different properties for which they have data (e.g. molecules whose densities and enthalpies of vaporization have been measured were prioritized over those were only density data was available)</li>
<li>the number of non-bonded interaction parameters which they exercise, especially those that have not yet been exercised by currently chosen molecules in the test set</li>
<li>the inverse of the number of atoms in the molecule, such that smaller molecules are preferred
The molecule (or pair of molecules for binary properties) which ranked at the top of this sorted list was then chosen for the test set and the list resorted and re-ranked according to the above criteria (paying attention to criteria 4b)).
This process was repeated until at least 10 molecules with excess molar volumes data, 10 molecules with enthalpy of mixing data and 30 molecules with pure densities, dielectric constant, and enthalpy of vaporization data were selected.
Specific data points for each molecule (or pair of molecules) selected for the test set were then chosen.</li>
</ol>
</li>
<li>This was accomplished by first specifying the state points at which we desired to have data, and then using a k-means clustering approach to cluster the available data around these points of interest. Within each cluster, we preferentially selected points for which multiple properties had been measured at the same conditions (again, this was done such that simulation data could be shared between different properties).
We tried to find data which was measured at 298 K and 1 atm, and for binary properties data which was measured at mole fractions of both 25% and 75%, such that the contributions of both molecules in the binary mix could be effectively evaluated.</li>
</ol>
<p>All of the steps described here have been made available as scripts in the <a href="https://github.com/openforcefield/release-1-benchmarking"><code>release-1-benchmarking</code> Github repository</a>.</p>
<center>
<img src="physprop-example-density.png" align="top" width="30%"> <img src="physprop-example-dielectric.png" align="top" width="30%"> <img src="physprop-example-hmix.jpg" align="top" width="30%">
</center>
**Example molecules included in the condensed phase physical property benchmark sets for pure densities, pure dielectrics, and enthalpies of mixing.**
The the fully curated set chosen by this approach contains 221 data points for 105 unique molecules, and is summarized [here](https://github.com/openforcefield/release-1-benchmarking/blob/master/physical_properties/release_1_benchmark_set.pdf).
<p><a id="physical-property-benchmark-results"></a></p>
<h4 id="condensed-phase-benchmark-results">Condensed phase benchmark results</h4>
<p>The curated set of condensed-phase properties was computed for five different popular small molecule force fields: <a href="https://github.com/openforcefield/smirnoff99Frosst/releases/tag/1.1.0">smirnoff99frosst 1.1.0</a>, <a href="https://github.com/openforcefield/openforcefield-forcebalance/releases/tag/v1.0.0-RC1">Parsley RC 1</a>, <a href="https://github.com/openforcefield/openforcefields/releases/tag/1.0.0">Parsley 1.0.0</a>, <a href="http://ambermd.org/antechamber/gaff.html">GAFF 1.81</a>, and GAFF 2.11 (shipped with the <a href="http://ambermd.org/AmberTools.php">ambertools19</a> conda package).
Calculations were performed using our propertyestimator GPU-accelerated distributed property computation framework v0.0.5 [https://github.com/openforcefield/propertyestimator] using scripts made available in the release-1-benchmark repo [https://github.com/openforcefield/release-1-benchmarking].</p>
<p>In general, the new Parsley 1.0.0 force field appears to perform well, showing marginal (although not statistically significant) improvements over the previous smirnoff99frosst 1.1.0 release, and appears to exhibit a comparable level of accuracy as the established GAFF family of force fields.</p>
<center>
<img src="physprop-benchmark-density.png" align="top" width="100%">
<img src="physprop-benchmark-dielectric.png" align="top" width="100%">
</center>
**Results of pure property benchmarks.**
95% confidence intervals reported for $$R^2$$ and RMSE where calculated using bootstrapping with replacement over 1000 iterations.
<center>
<img src="physprop-benchmark-hvap.png" align="top" width="100%">
<img src="physprop-benchmark-hmix.png" align="top" width="100%">
</center>
**Results of binary mixture property benchmarks.**
95% confidence intervals reported for $$R^2$$ and RMSE where calculated using bootstrapping with replacement over 1000 iterations.
<br>
<a id="future-plans"></a>
## Plans for additional benchmarks
<p>We provide our Parsley release after benchmarking on a range of quantum chemical data and several condensed phase properties, including properties not used during optimization. However, much more benchmarking and testing is warranted, and we look forward to working with the community to continue to assess the performance of Parsley and identifying areas that can be improved in subsequent releases.</p>
<p>We are looking into several additional areas for benchmarking in the near term, including:</p>
<ul>
<li>Host-guest binding free energy calculations</li>
<li>Performance in conformer generation/optimization workflows</li>
<li>Tests in PDB ligand strain energy</li>
<li>Protein-ligand binding free energy calculations</li>
<li>Comparisons to other force fields</li>
<li>Performance on other physical properties, including hydration and transfer free energies (though in many cases these are not likely to be impacted dramatically by valence parameter changes)</li>
</ul>
<p>We also look forward to testing on a broader range of chemistry than that employed in our first round of benchmarks. If you are interested in working with us to further benchmark Parsley, please <a href="http://openforcefield.org">contact us</a>!</p>

			</div>
			
			<div>
				<div id="tags" class="p-y-lg">
					Tags:
					<a href="/tags/news">news</a>, <a href="/tags/general">general</a>, <a href="/tags/smirnoff">smirnoff</a>, <a href="/tags/parsley">parsley</a>, <a href="/tags/openff-1.0.0">OpenFF-1.0.0</a>, <a href="/tags/force-fields">force fields</a>
				</div>
			</div>
			
		</article>
	</main>

	<footer>
	
	<div class="footer-left">
		
			
				<div><img src="/images/logo.svg" /></div>
			
		
			
				<div>An open and collaborative approach to better force fields</div>
			
		
	</div>
	<div class="footer-column1">
		
			
				<a href="/about" class="">About</a>
			
		
			
				<a href="/about/organization" class="footer-has-child">Organization</a>
			
		
			
				<a href="/about/roadmap" class="footer-has-child">Roadmap</a>
			
		
			
				<a href="/about/team" class="footer-has-child">Team</a>
			
		
			
				<a href="/about/careers" class="footer-has-child">Careers</a>
			
		
			
				<a href="/about/branding" class="footer-has-child">Branding</a>
			
		
	</div>
	<div class="footer-column2">
		
			
				<a href="/science" class="">Science</a>
			
		
			
				<a href="/science/research" class="footer-has-child">Research</a>
			
		
			
				<a href="/science/publications" class="footer-has-child">Publications</a>
			
		
			
				<a href="/science/collaborative-projects/" class="footer-has-child">Collaborative projects</a>
			
		
			
				<a href="/science//how-to-cite/" class="footer-has-child">How to Cite</a>
			
		
	</div>
	<div class="footer-column3">
		
			
				<a href="/software" class="">Software</a>
			
		
			
				<a href="/data" class="">Data</a>
			
		
			
				<a href="/force-fields" class="">Force Fields</a>
			
		
			
				<a href="/force-fields/force-fields" class="footer-has-child">Force Fields</a>
			
		
			
				<a href="/force-fields/versioning" class="footer-has-child">Versioning</a>
			
		
	</div>
	<div class="footer-column4">
		
			
				<a href="/community" class="">Community</a>
			
		
			
				<a href="/community/news" class="footer-has-child">News</a>
			
		
			
				<a href="/community/events" class="footer-has-child">Events</a>
			
		
			
				<a href="/community/collaborate" class="footer-has-child">Collaborate</a>
			
		
			
				<a href="/community/faq" class="footer-has-child">FAQ</a>
			
		
			
				<a href="/community/forum" class="footer-has-child">Forum</a>
			
		
	</div>
	<div class="footer-right">
		
			
				<div>Follow | Subscribe | Connect</div>
			
		
			
				
				
					<a href="mailto:info@openforcefield.org">
				
				<div class="footer-icon"><svg width="19" height="16" viewBox="0 0 19 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.585 1.59668H2.72386C1.81252 1.59668 1.07373 2.33547 1.07373 3.24681V13.1476C1.07373 14.0589 1.81252 14.7977 2.72386 14.7977H16.585C17.4963 14.7977 18.2351 14.0589 18.2351 13.1476V3.24681C18.2351 2.33547 17.4963 1.59668 16.585 1.59668Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M3.71387 4.23682L9.65434 8.85719L15.5948 4.23682" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://twitter.com/openforcefield">
				
				<div class="footer-icon"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M19.9639 2.31073C19.2404 2.6251 18.4749 2.83221 17.6915 2.92552C18.5148 2.44349 19.1338 1.67768 19.4327 0.771743C18.6544 1.22685 17.8043 1.54617 16.9188 1.71603C16.546 1.32527 16.0976 1.01441 15.6008 0.80234C15.1041 0.590273 14.5694 0.48143 14.0293 0.482429C11.8426 0.482429 10.0729 2.22635 10.0729 4.37611C10.0714 4.67514 10.1057 4.97327 10.175 5.26415C8.60696 5.19064 7.07153 4.79063 5.66693 4.08971C4.26233 3.3888 3.01951 2.40241 2.01796 1.19366C1.6666 1.786 1.48078 2.46184 1.47992 3.15055C1.47992 4.50068 2.18432 5.6941 3.24795 6.39327C2.61778 6.37832 2.00052 6.21153 1.44858 5.90707V5.95528C1.44858 7.84386 2.81478 9.415 4.62299 9.77262C4.28296 9.86327 3.93257 9.90919 3.58066 9.90924C3.33096 9.90968 3.08182 9.88545 2.83688 9.83691C3.33957 11.3839 4.80261 12.5091 6.53568 12.5412C5.12744 13.6265 3.39848 14.2131 1.62056 14.2088C1.30497 14.2083 0.989679 14.1895 0.67627 14.1525C2.48496 15.3074 4.58741 15.9184 6.73338 15.9125C14.0209 15.9125 18.0022 9.97755 18.0022 4.83017C18.0022 4.66141 17.9977 4.49264 17.9897 4.32789C18.7624 3.77822 19.431 3.09514 19.9639 2.31073Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://github.com/openforcefield">
				
				<div class="footer-icon"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M8.98633 0.833008C4.36732 0.833008 0.62207 4.67534 0.62207 9.41011C0.62207 13.2002 3.01933 16.4114 6.34263 17.5466C6.38924 17.5567 6.43682 17.5617 6.48452 17.5615C6.79444 17.5615 6.91393 17.3337 6.91393 17.1358C6.91393 16.9305 6.90647 16.3928 6.90273 15.6758C6.62605 15.7407 6.34301 15.7745 6.05884 15.7766C4.44947 15.7766 4.08353 14.5257 4.08353 14.5257C3.70266 13.5362 3.15375 13.2711 3.15375 13.2711C2.42561 12.7595 3.15002 12.7446 3.20603 12.7446H3.20976C4.04992 12.8193 4.49054 13.6333 4.49054 13.6333C4.90875 14.3652 5.46886 14.5706 5.96922 14.5706C6.30007 14.5639 6.6258 14.4876 6.92514 14.3465C6.99982 13.7939 7.21639 13.4167 7.45537 13.2002C5.59955 12.9836 3.64665 12.248 3.64665 8.96202C3.64665 8.02478 3.97151 7.2593 4.50548 6.66185C4.41959 6.44527 4.13207 5.57151 4.58762 4.39155C4.64873 4.37693 4.71153 4.37065 4.77433 4.37288C5.07678 4.37288 5.76011 4.48864 6.8878 5.27279C8.25802 4.88942 9.70717 4.88942 11.0774 5.27279C12.2051 4.48864 12.8884 4.37288 13.1909 4.37288C13.2537 4.37065 13.3165 4.37693 13.3776 4.39155C13.8331 5.57151 13.5456 6.44527 13.4597 6.66185C13.9937 7.26303 14.3185 8.02851 14.3185 8.96202C14.3185 12.2554 12.3619 12.9799 10.4986 13.1927C10.7973 13.4578 11.0662 13.9806 11.0662 14.7797C11.0662 15.926 11.055 16.8521 11.055 17.1321C11.055 17.3337 11.1707 17.5615 11.4807 17.5615C11.5308 17.5617 11.5809 17.5567 11.63 17.5466C14.9571 16.4114 17.3506 13.1964 17.3506 9.41011C17.3506 4.67534 13.6053 0.833008 8.98633 0.833008Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://zenodo.org/communities/openforcefield/?page=1&amp;size=20">
				
				<div class="footer-icon"><svg width="27" height="10" viewBox="0 0 27 10" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M22.15 7.99361C21.7106 8.91738 21.0047 9.45437 19.972 9.45812C18.9393 9.46188 18.2259 8.9324 17.779 8.01614C17.3809 8.86481 16.7238 9.37926 15.7775 9.45061C14.8312 9.52196 14.1027 9.1164 13.577 8.31655C13.577 8.35035 13.5732 8.37288 13.5732 8.39541C13.5732 8.59444 13.577 8.79721 13.5695 8.99624C13.5619 9.24783 13.3479 9.45812 13.0926 9.46563C12.8184 9.46939 12.6081 9.27788 12.5894 9.01501C12.5856 8.97371 12.5856 8.93616 12.5856 8.89485C12.5856 7.67818 12.5856 6.4615 12.5856 5.24483C12.5856 4.62147 12.1913 4.08073 11.6168 3.91175C10.7343 3.65264 9.87062 4.28727 9.86311 5.20728C9.85936 5.66916 9.86311 6.13105 9.86311 6.59294C9.86311 6.62298 9.86311 6.65677 9.86311 6.69057C8.40611 6.69057 6.95662 6.69057 5.51464 6.69057C5.50713 6.70183 5.49962 6.70559 5.49962 6.70934C5.49211 7.06984 5.46957 7.43034 5.65733 7.76079C5.93146 8.23394 6.33326 8.48554 6.88152 8.47427C7.43352 8.46676 7.83157 8.20014 8.08317 7.71197C8.11696 7.64438 8.15076 7.58054 8.1808 7.50919C8.25966 7.32895 8.3986 7.21629 8.59011 7.21254C9.00694 7.20503 9.42751 7.20878 9.85185 7.20878C9.8556 7.23131 9.85936 7.25384 9.85936 7.27262C9.85936 7.83214 9.86311 8.39166 9.85936 8.95118C9.8556 9.2929 9.5627 9.52196 9.236 9.4431C9.02947 9.39429 8.87926 9.20277 8.87551 8.98873C8.87175 8.76717 8.87551 8.54562 8.87551 8.30153C8.48872 8.90987 7.97427 9.30041 7.27581 9.42057C6.58861 9.54074 5.95774 9.38302 5.39447 8.95118C5.39072 8.98122 5.38696 8.99624 5.3832 9.01501C5.33063 9.24408 5.13912 9.40555 4.90254 9.40931C4.41813 9.41306 3.93747 9.40931 3.45305 9.40931C2.70202 9.40931 1.95474 9.4018 1.20371 9.41306C0.865745 9.41682 0.632925 9.16897 0.644191 8.84979C0.655456 8.3879 0.62166 8.44798 0.903297 8.06871C1.90593 6.71686 2.90855 5.36875 3.91118 4.01689C3.92996 3.99061 3.95249 3.96057 3.98253 3.91926C3.94122 3.91926 3.91494 3.91926 3.8849 3.91926C3.00619 3.91926 2.12372 3.91926 1.24502 3.91926C1.00093 3.91926 0.805663 3.78032 0.741825 3.56252C0.644191 3.23582 0.880766 2.91663 1.23 2.91288C1.57923 2.90912 1.92846 2.91288 2.27769 2.91288C3.06627 2.91288 3.85485 2.92039 4.64719 2.90912C4.99267 2.90537 5.25553 3.10814 5.24426 3.48742C5.86011 2.94292 6.56608 2.74389 7.35466 2.91663C8.15076 3.08937 8.69526 3.58129 9.02571 4.32106C9.47258 3.40105 10.1823 2.86781 11.2187 2.86781C12.2514 2.87157 12.9611 3.40105 13.3967 4.31731C13.8361 3.40105 14.5496 2.86781 15.5822 2.86781C16.6186 2.86781 17.3284 3.4048 17.7715 4.33233C18.0719 3.64513 18.5638 3.17198 19.2848 2.95794C20.0058 2.74389 20.6742 2.87532 21.3126 3.29966C21.3126 3.25835 21.3126 3.23206 21.3126 3.20578C21.3126 2.61997 21.3126 2.03417 21.3126 1.44461C21.3126 1.17048 21.4741 0.975212 21.7332 0.933906C22.0148 0.888844 22.2927 1.11791 22.2927 1.4033C22.2965 2.09801 22.2927 2.79647 22.2927 3.49117C22.2927 3.5137 22.2889 3.53999 22.2777 3.55876C22.1387 3.79158 22.1049 4.05445 22.0824 4.31731C22.0787 4.36237 22.0787 4.40743 22.0862 4.45249C22.1049 4.40368 22.1237 4.35486 22.1462 4.30604C22.4955 3.50619 23.1038 3.02553 23.9637 2.88659C25.2405 2.6763 26.4722 3.59632 26.6412 4.87307C26.6524 4.9707 26.66 5.06834 26.66 5.16973C26.66 5.83064 26.6637 6.49155 26.66 7.15245C26.6524 8.23019 25.9089 9.14644 24.8575 9.39429C23.7685 9.64964 22.6682 9.1164 22.1913 8.10251C22.1913 8.07622 22.1725 8.03867 22.15 7.99361ZM21.3201 6.16485C21.3239 6.16485 21.3239 6.16485 21.3276 6.16485C21.3276 5.86443 21.3314 5.56402 21.3276 5.25985C21.3239 5.13969 21.3201 5.01952 21.2901 4.90311C21.1324 4.21967 20.509 3.79158 19.7955 3.86669C19.1421 3.93428 18.6126 4.52384 18.6089 5.20352C18.6051 5.84941 18.6051 6.4953 18.6089 7.13743C18.6126 7.89973 19.221 8.48929 19.9833 8.47803C20.693 8.46676 21.2713 7.93728 21.3164 7.22756C21.3389 6.87457 21.3201 6.51783 21.3201 6.16485ZM14.2379 6.16485C14.2379 6.49154 14.2341 6.822 14.2379 7.1487C14.2529 8.0612 15.1504 8.69958 16.0178 8.41794C16.5849 8.23394 16.9529 7.72324 16.9529 7.09988C16.9566 6.48028 16.9529 5.86443 16.9529 5.24483C16.9529 5.16597 16.9491 5.09087 16.9378 5.01201C16.8364 4.32857 16.2056 3.81411 15.5259 3.85918C14.7936 3.90799 14.2491 4.46376 14.2379 5.18099C14.2341 5.50769 14.2379 5.83439 14.2379 6.16485ZM25.6911 6.1686C25.6911 5.85692 25.6911 5.54524 25.6911 5.23357C25.6911 5.15471 25.6874 5.07209 25.6723 4.99324C25.5559 4.34735 25.0603 3.90424 24.4069 3.85918C23.6708 3.8066 23.0137 4.38114 22.9761 5.11716C22.9649 5.32369 22.9724 5.53398 22.9724 5.74051C22.9724 6.23244 22.9574 6.72812 22.9799 7.22005C23.0099 7.99736 23.7722 8.59444 24.5383 8.46676C25.2292 8.35035 25.6911 7.80585 25.6911 7.10739C25.6911 6.79196 25.6911 6.48028 25.6911 6.1686ZM1.91719 8.41043C2.91982 8.41043 3.90367 8.41043 4.89879 8.41043C4.88377 8.38415 4.8725 8.36537 4.86124 8.35035C4.62466 7.97108 4.50825 7.55426 4.51201 7.10739C4.51576 6.47652 4.51201 5.84941 4.51201 5.21855C4.51201 5.11716 4.51201 5.01952 4.51201 4.91438C3.65208 6.07472 2.78839 7.23882 1.91719 8.41043ZM8.20709 5.70296C8.20709 5.47014 8.22962 5.24108 8.20333 5.01952C8.13198 4.42621 7.62504 3.93804 7.03923 3.87044C6.41212 3.79534 5.84133 4.12579 5.601 4.69282C5.46206 5.01952 5.51088 5.36124 5.49962 5.70296C6.40836 5.70296 7.3096 5.70296 8.20709 5.70296Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://www.linkedin.com/company/openforcefield/">
				
				<div class="footer-icon"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.345 0.833008H2.38374C1.62087 0.833008 0.954346 1.38191 0.954346 2.13582V16.128C0.954346 16.886 1.62087 17.5615 2.38374 17.5615H16.3409C17.1078 17.5615 17.6829 16.8816 17.6829 16.128V2.13582C17.6873 1.38191 17.1078 0.833008 16.345 0.833008ZM6.13981 14.7771H3.7433V7.32577H6.13981V14.7771ZM5.02446 6.19286H5.00728C4.24031 6.19286 3.74368 5.62192 3.74368 4.90722C3.74368 4.17946 4.25337 3.62197 5.03752 3.62197C5.82167 3.62197 6.3015 4.17535 6.31868 4.90722C6.3183 5.62192 5.82167 6.19286 5.02446 6.19286ZM14.8984 14.7771H12.5019V10.7028C12.5019 9.72676 12.1531 9.05986 11.2861 9.05986C10.6237 9.05986 10.2316 9.50794 10.0572 9.94445C9.99185 10.1013 9.97431 10.3149 9.97431 10.5329V14.7771H7.5778V7.32577H9.97431V8.36271C10.3231 7.86608 10.8679 7.15139 12.1356 7.15139C13.7087 7.15139 14.8988 8.18833 14.8988 10.4239L14.8984 14.7771Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="https://www.youtube.com/channel/UCh0aJSUm_sYr7nuTzhW806g">
				
				<div class="footer-icon"><svg width="22" height="17" viewBox="0 0 22 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M21.3762 3.78816C21.3762 1.93759 20.015 0.448904 18.3331 0.448904C16.0548 0.342393 13.7313 0.30127 11.3568 0.30127H10.6166C8.24785 0.30127 5.92024 0.342393 3.64198 0.449315C1.96412 0.449315 0.602924 1.94622 0.602924 3.7968C0.500114 5.2604 0.456523 6.72441 0.45899 8.18842C0.454878 9.65242 0.501485 11.1178 0.598811 12.5846C0.598811 14.4351 1.96001 15.9362 3.63786 15.9362C6.03127 16.0472 8.48637 16.0965 10.9826 16.0924C13.4829 16.1006 15.9312 16.0486 18.3273 15.9362C20.0093 15.9362 21.3705 14.4351 21.3705 12.5846C21.4692 11.1164 21.5144 9.65242 21.5103 8.1843C21.5196 6.72029 21.4749 5.25491 21.3762 3.78816ZM8.97163 12.2227V4.14183L14.9346 8.18019L8.97163 12.2227Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
			
				
				
					<a href="http://eepurl.com/gYuojL">
				
				<div class="footer-icon"><svg width="19" height="21" viewBox="0 0 19 21" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.0794 9.62959C14.2146 9.62959 14.3498 9.62959 14.485 9.62959C14.5711 9.44519 14.5711 9.17475 14.485 8.86743C14.399 8.4126 14.2638 8.10528 13.9933 8.14215C13.7229 8.19133 13.7229 8.54782 13.8089 9.00265C13.8458 9.27309 13.9442 9.49437 14.0794 9.62959Z" fill="white"/>
<path d="M11.6945 10.0353C11.8789 10.1214 12.0141 10.1706 12.051 10.1214C12.1001 10.0722 12.051 10.0353 12.0018 9.93699C11.9157 9.7526 11.6822 9.61738 11.5101 9.53133C11.0552 9.34694 10.5635 9.39611 10.1579 9.71572C10.0226 9.80177 9.88742 9.93699 9.93659 10.0353C9.93659 10.0845 9.98576 10.0845 10.0226 10.0845C10.1087 10.0845 10.5144 9.90011 10.9692 9.86323C11.2396 9.85094 11.5101 9.94928 11.6945 10.0353Z" fill="white"/>
<path d="M11.2888 10.2562C11.0184 10.3053 10.8831 10.3914 10.7971 10.4774C10.711 10.5635 10.6619 10.6126 10.6619 10.6618V10.711H10.711C10.7602 10.711 10.8954 10.6618 10.8954 10.6618C11.2519 10.5266 11.4855 10.5266 11.7068 10.5758C11.842 10.5758 11.8911 10.6249 11.928 10.5758C11.928 10.5758 11.928 10.5266 11.928 10.4897C11.9157 10.3545 11.6453 10.2193 11.2888 10.2562Z" fill="white"/>
<path d="M11.4241 10.5758C11.5102 10.3914 11.5102 9.98572 11.4241 9.6784C11.3381 9.22357 11.2028 8.95312 10.8832 8.95312C10.6128 9.0023 10.6128 9.35879 10.6988 9.8505C10.748 10.1701 10.8832 10.3422 10.9201 10.4774C11.1537 10.8462 11.2889 10.7479 11.4241 10.5758Z" fill="white"/>
<path d="M13.268 11.0678C13.4524 11.1538 13.6245 11.117 13.7228 10.9817C13.772 10.8465 13.6736 10.6621 13.5015 10.5761C13.3171 10.49 13.145 10.5269 13.0467 10.6621C12.9484 10.7973 13.0836 10.9817 13.268 11.0678Z" fill="white"/>
<path d="M14.3867 10.084C14.2514 10.084 14.1162 10.2192 14.1162 10.4405C14.1162 10.6249 14.2023 10.797 14.3867 10.797C14.5219 10.797 14.6571 10.6617 14.6571 10.4405C14.6202 10.2561 14.5219 10.084 14.3867 10.084Z" fill="white"/>
<path d="M4.85982 13.5878C4.81064 13.5386 4.77377 13.5386 4.7246 13.5878C4.67542 13.5878 4.63855 13.5878 4.58937 13.5878C4.50332 13.5878 4.40498 13.5386 4.3681 13.4525C4.33122 13.3665 4.31893 13.2313 4.3681 13.0469L4.41727 12.9608C4.5525 12.6904 4.73689 12.2847 4.50332 11.8791C4.31893 11.5594 4.09766 11.3873 3.77805 11.3382C3.45843 11.289 3.15111 11.4242 2.96672 11.6578C2.64711 12.0143 2.61023 12.4691 2.64711 12.6412C2.64711 12.6904 2.69628 12.7273 2.73316 12.7273C2.78233 12.7273 2.86838 12.6781 2.91755 12.5429V12.4937C2.91755 12.4076 2.96672 12.3093 3.05277 12.1741C3.13882 12.0389 3.27404 11.9528 3.40926 11.9528C3.54448 11.9036 3.72888 11.9528 3.8641 12.0389C4.08537 12.1741 4.18371 12.4445 4.08537 12.715C3.95015 12.8502 3.90098 13.0715 3.90098 13.305C3.95015 13.7107 4.22059 13.8951 4.44186 13.932C4.66313 13.932 4.84752 13.7967 4.84752 13.7107C4.89669 13.6369 4.85982 13.6369 4.85982 13.5878Z" fill="white"/>
<path d="M17.9393 12.8256C17.9393 12.7764 17.8901 12.6043 17.8041 12.3339L17.6197 11.9282C17.9393 11.4734 17.9393 11.0308 17.8901 10.8096C17.8409 10.5391 17.7057 10.2687 17.4845 9.99822C17.2632 9.72778 16.7223 9.45734 16.0462 9.27295L15.6897 9.1869C15.6897 9.1869 15.6897 8.3264 15.6405 7.96991C15.6405 7.69947 15.5914 7.29381 15.4561 6.88814C15.3209 6.34726 15.0505 5.85555 14.694 5.53593C15.5914 4.58939 16.1814 3.50761 16.1814 2.61024C16.1814 0.901538 14.0671 0.360654 11.4118 1.44242L10.8709 1.66369C10.8709 1.66369 9.88749 0.680267 9.83832 0.680267C6.92492 -1.92581 -2.38074 8.46162 0.58183 10.9816L1.20876 11.5225C1.02437 11.9774 0.987493 12.4691 1.02437 13.01C1.11042 13.6861 1.47921 14.3622 2.0078 14.9031C2.54868 15.3948 3.26166 15.7144 3.98694 15.7144C5.15476 18.4188 7.81001 20.0292 10.9078 20.1275C14.2392 20.2136 17.0665 18.6401 18.2343 15.8496C18.3204 15.6652 18.64 14.7678 18.64 13.9565C18.7137 13.1329 18.2589 12.8256 17.9393 12.8256ZM4.26968 14.9399C4.18363 14.9399 4.0484 14.9891 3.95006 14.9399C2.96664 14.8908 1.8357 13.9934 1.74965 12.9116C1.6636 11.7438 2.24136 10.8464 3.32313 10.6129C3.45835 10.5637 3.59357 10.5637 3.77796 10.5637C4.36802 10.6129 5.26539 11.0554 5.48666 12.3584C5.65876 13.5877 5.40061 14.7555 4.26968 14.9399ZM3.15103 9.89988C2.47492 10.0351 1.89716 10.3916 1.52838 10.9325C1.30711 10.7481 0.901443 10.3916 0.852272 10.2564C0.262217 9.17461 1.47921 7.02336 2.3397 5.84325C4.4049 2.88068 7.68708 0.631096 9.17451 1.02447C9.44495 1.11052 10.2563 2.05706 10.2563 2.05706C10.2563 2.05706 8.73197 2.91756 7.33059 4.08538C5.43749 5.48676 3.99923 7.60113 3.15103 9.89988ZM13.7597 14.4851L13.8089 14.4359C13.8089 14.3868 13.7597 14.3868 13.7597 14.3868C13.7597 14.3868 12.1863 14.608 10.6988 14.0671C10.8832 13.5263 11.2889 13.7107 11.9527 13.7967C13.1205 13.8828 14.2023 13.7107 14.9644 13.4771C15.6405 13.2927 16.5379 12.887 17.214 12.3584C17.4353 12.8502 17.5336 13.4402 17.5336 13.4402C17.5336 13.4402 17.718 13.391 17.8532 13.4894C17.9885 13.5754 18.0745 13.7598 18.0376 14.2147C17.9024 15.112 17.4967 15.7881 16.919 16.4642C16.5625 16.8699 16.0585 17.2264 15.5299 17.4968C15.2595 17.6321 14.9398 17.7673 14.6325 17.8533C12.1985 18.6155 9.77686 17.8042 9.0147 15.9602C8.96553 15.825 8.87948 15.6898 8.87948 15.5054C8.55987 14.2884 8.83031 12.8502 9.73998 11.9528C9.78915 11.9036 9.82603 11.8176 9.82603 11.7315C9.82603 11.6455 9.77686 11.5963 9.73998 11.5471C9.42037 11.0923 8.35089 10.3301 8.57216 8.8427C8.70738 7.76093 9.65393 7.04795 10.5021 7.08482H10.7234C11.0799 7.08482 11.4487 7.17088 11.7068 7.17088C12.1985 7.17088 12.6903 7.1217 13.2311 6.67916C13.4155 6.54394 13.5508 6.40872 13.8212 6.35955C13.8704 6.35955 13.9072 6.31038 14.0425 6.35955C14.1777 6.35955 14.3129 6.40872 14.399 6.49477C14.8538 6.81438 14.8907 7.4782 14.9398 8.01908C14.9398 8.33869 14.989 9.05168 14.989 9.23607C15.0382 9.6909 15.1242 9.77695 15.3947 9.863C15.5299 9.91217 15.6651 9.94905 15.8495 9.99822C16.4396 10.1826 16.7961 10.3178 17.0173 10.5391C17.1525 10.6743 17.2017 10.8096 17.2386 10.9448C17.3246 11.4365 16.8329 12.0634 15.6159 12.6535C14.2637 13.2804 12.6903 13.4156 11.5716 13.2804L11.1659 13.2312C10.2686 13.096 9.77686 14.2638 10.3054 15.026C10.6619 15.5177 11.6085 15.8865 12.5059 15.8865C14.6694 15.8865 16.3289 14.9891 16.919 14.1778L16.9682 14.0917C17.0173 14.0426 16.9682 14.0057 16.919 14.0426C16.4273 14.3991 14.1777 15.7513 11.7929 15.3456C11.7929 15.3456 11.5224 15.2964 11.252 15.2104C11.0307 15.1243 10.6251 14.9399 10.5267 14.4851C12.5427 15.0752 13.7597 14.4851 13.7597 14.4851ZM7.01097 5.85554C7.73625 4.99505 8.6705 4.23289 9.48183 3.82723C9.531 3.82723 9.531 3.82723 9.531 3.8764C9.48183 4.01162 9.34661 4.23289 9.30973 4.41728C9.30973 4.46646 9.3589 4.46646 9.3589 4.46646C9.85061 4.10996 10.748 3.74118 11.5224 3.7043C11.5716 3.7043 11.5716 3.75347 11.5716 3.75347C11.4364 3.83952 11.3503 3.97474 11.2151 4.10996C11.2151 4.10996 11.2151 4.15914 11.2643 4.15914C11.8052 4.15914 12.5673 4.34353 13.059 4.65085C13.1082 4.65085 13.059 4.7369 13.0099 4.7369C12.2477 4.55251 11.0307 4.41729 9.72769 4.7369C8.55987 5.00734 7.69937 5.46218 7.07244 5.90472C7.01097 5.89242 6.9741 5.89242 7.01097 5.85554Z" fill="white"/>
</svg>
</div>
				
					</a>
				
			
		
		<div><br />Content licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0.</a><br />Website by <a href="https://www.vanleeuwenvanleeuwen.nl/">van Leeuwen & van Leeuwen</a><br />and the Open Force Field Initiative.</div>
	</div>
</footer>

</body>
</html>
